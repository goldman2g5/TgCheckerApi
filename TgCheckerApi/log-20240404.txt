2024-04-04 18:08:24.444 +03:00 [INF] User profile is available. Using 'C:\Users\79103\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-04-04 18:08:24.969 +03:00 [INF] Default Quartz.NET properties loaded from embedded resource file
2024-04-04 18:08:25.051 +03:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2024-04-04 18:08:25.052 +03:00 [INF] Quartz Scheduler created
2024-04-04 18:08:25.053 +03:00 [INF] RAMJobStore initialized.
2024-04-04 18:08:25.055 +03:00 [INF] Quartz Scheduler 3.8.0.0 - 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2024-04-04 18:08:25.056 +03:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2024-04-04 18:08:25.057 +03:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2024-04-04 18:08:25.059 +03:00 [INF] JobFactory set to: TgCheckerApi.Quartz.QuartzJobFactory
2024-04-04 18:08:25.138 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-04-04 18:08:25.283 +03:00 [INF] JobFactory set to: TgCheckerApi.Quartz.QuartzJobFactory
2024-04-04 18:08:25.287 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-04-04 18:08:25.365 +03:00 [INF] LoadDelayedNotificationsJob started at "2024-04-04T18:08:25.3560540+03:00"
2024-04-04 18:08:25.365 +03:00 [INF] RecalculateTopPosJob started at "2024-04-04T18:08:25.3656557+03:00"
2024-04-04 18:08:27.306 +03:00 [INF] Executed DbCommand (67ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c.tgclient_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
ORDER BY c.bumps DESC
2024-04-04 18:08:27.306 +03:00 [INF] Executed DbCommand (66ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT n.id, n.channel_id, n.content, n.content_type, n.date, n.target_telegram, n.type_id, n.user_id
FROM "NotificationDelayedTask" AS n
2024-04-04 18:08:27.347 +03:00 [INF] All NotificationDelayedTasks are loaded and scheduled.
2024-04-04 18:08:27.565 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32), @p3='?' (DbType = Int32), @p2='?' (DbType = Int32), @p5='?' (DbType = Int32), @p4='?' (DbType = Int32), @p7='?' (DbType = Int32), @p6='?' (DbType = Int32), @p9='?' (DbType = Int32), @p8='?' (DbType = Int32), @p11='?' (DbType = Int32), @p10='?' (DbType = Int32), @p13='?' (DbType = Int32), @p12='?' (DbType = Int32), @p15='?' (DbType = Int32), @p14='?' (DbType = Int32), @p17='?' (DbType = Int32), @p16='?' (DbType = Int32), @p19='?' (DbType = Int32), @p18='?' (DbType = Int32), @p21='?' (DbType = Int32), @p20='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Channel" SET "TopPos" = @p0
WHERE id = @p1;
UPDATE "Channel" SET "TopPos" = @p2
WHERE id = @p3;
UPDATE "Channel" SET "TopPos" = @p4
WHERE id = @p5;
UPDATE "Channel" SET "TopPos" = @p6
WHERE id = @p7;
UPDATE "Channel" SET "TopPos" = @p8
WHERE id = @p9;
UPDATE "Channel" SET "TopPos" = @p10
WHERE id = @p11;
UPDATE "Channel" SET "TopPos" = @p12
WHERE id = @p13;
UPDATE "Channel" SET "TopPos" = @p14
WHERE id = @p15;
UPDATE "Channel" SET "TopPos" = @p16
WHERE id = @p17;
UPDATE "Channel" SET "TopPos" = @p18
WHERE id = @p19;
UPDATE "Channel" SET "TopPos" = @p20
WHERE id = @p21;
2024-04-04 18:08:27.619 +03:00 [INF] RecalculateTopPosJob completed at "2024-04-04T18:08:27.6198273+03:00"
2024-04-04 18:08:30.816 +03:00 [INF] Now listening on: http://localhost:7256
2024-04-04 18:08:30.817 +03:00 [INF] Now listening on: http://localhost:5244
2024-04-04 18:08:30.819 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-04-04 18:08:30.820 +03:00 [INF] Hosting environment: Development
2024-04-04 18:08:30.821 +03:00 [INF] Content root path: C:\Users\79103\Source\Repos\goldman2g5\TgCheckerApi4.1\TgCheckerApi\
2024-04-04 18:08:31.478 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/index.html - -
2024-04-04 18:08:31.795 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/index.html - - - 200 - text/html;charset=utf-8 321.5474ms
2024-04-04 18:08:31.810 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - -
2024-04-04 18:08:31.814 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_vs/browserLink - -
2024-04-04 18:08:31.816 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - - - 200 12356 application/javascript;+charset=utf-8 6.2704ms
2024-04-04 18:08:31.877 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 63.7826ms
2024-04-04 18:08:31.912 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - -
2024-04-04 18:08:32.144 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 232.4811ms
2024-04-04 18:08:35.517 +03:00 [INF] Start processing HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-04-04 18:08:35.522 +03:00 [INF] Sending HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-04-04 18:09:22.073 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=80&startDate=04.04.2024&endDate=03.04.2024 - -
2024-04-04 18:09:22.086 +03:00 [WRN] Failed to determine the https port for redirect.
2024-04-04 18:09:22.241 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:09:22.297 +03:00 [INF] Route matched with {action = "GetMessagesByPeriod", controller = "Telegram"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByPeriodAsync(Int64, System.DateTime, System.DateTime) on controller TgCheckerApi.Controllers.TelegramController (TgCheckerApi).
2024-04-04 18:09:22.355 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'System.String'.
2024-04-04 18:09:22.364 +03:00 [INF] Executed action TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi) in 56.8172ms
2024-04-04 18:09:22.367 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:09:22.372 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=80&startDate=04.04.2024&endDate=03.04.2024 - - - 404 - text/plain;+charset=utf-8 298.6244ms
2024-04-04 18:09:43.069 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=-1001748293344&startDate=04.04.2024&endDate=03.04.2024 - -
2024-04-04 18:09:43.074 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:09:43.075 +03:00 [INF] Route matched with {action = "GetMessagesByPeriod", controller = "Telegram"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByPeriodAsync(Int64, System.DateTime, System.DateTime) on controller TgCheckerApi.Controllers.TelegramController (TgCheckerApi).
2024-04-04 18:09:43.602 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.OrderedEnumerable`2[[<>f__AnonymousType10`3[[System.Int32, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-04-04 18:09:43.632 +03:00 [INF] Executed action TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi) in 552.6666ms
2024-04-04 18:09:43.635 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:09:43.637 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=-1001748293344&startDate=04.04.2024&endDate=03.04.2024 - - - 200 2 application/json;+charset=utf-8 567.9573ms
2024-04-04 18:09:52.893 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=-1001748293344&startDate=04.04.2024&endDate=03.04.2024 - -
2024-04-04 18:09:52.899 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:09:52.902 +03:00 [INF] Route matched with {action = "GetMessagesByPeriod", controller = "Telegram"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByPeriodAsync(Int64, System.DateTime, System.DateTime) on controller TgCheckerApi.Controllers.TelegramController (TgCheckerApi).
2024-04-04 18:09:53.286 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.OrderedEnumerable`2[[<>f__AnonymousType10`3[[System.Int32, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-04-04 18:09:53.289 +03:00 [INF] Executed action TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi) in 384.3188ms
2024-04-04 18:09:53.291 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:09:53.292 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=-1001748293344&startDate=04.04.2024&endDate=03.04.2024 - - - 200 2 application/json;+charset=utf-8 398.9566ms
2024-04-04 18:09:58.769 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=-1001748293344&startDate=03.04.2024&endDate=04.04.2024 - -
2024-04-04 18:09:58.771 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:09:58.773 +03:00 [INF] Route matched with {action = "GetMessagesByPeriod", controller = "Telegram"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByPeriodAsync(Int64, System.DateTime, System.DateTime) on controller TgCheckerApi.Controllers.TelegramController (TgCheckerApi).
2024-04-04 18:10:15.597 +03:00 [ERR] Error occurred executing UpdateSubscribersJob via HTTP request.
System.Threading.Tasks.TaskCanceledException: The request was canceled due to the configured HttpClient.Timeout of 100 seconds elapsing.
 ---> System.TimeoutException: The operation was canceled.
 ---> System.Threading.Tasks.TaskCanceledException: The operation was canceled.
 ---> System.IO.IOException: Unable to read data from the transport connection: The I/O operation has been aborted because of either a thread exit or an application request..
 ---> System.Net.Sockets.SocketException (995): The I/O operation has been aborted because of either a thread exit or an application request.
   --- End of inner exception stack trace ---
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource<System.Int32>.GetResult(Int16 token)
   at System.Net.Security.SslStream.EnsureFullTlsFrameAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ReadAsyncInternal[TIOAdapter](TIOAdapter adapter, Memory`1 buffer)
   at System.Net.Http.HttpConnection.InitialFillAsync(Boolean async)
   at System.Net.Http.HttpConnection.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.HttpConnection.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithVersionDetectionAndRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at Microsoft.Extensions.Http.Logging.LoggingHttpMessageHandler.SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)
   at Microsoft.Extensions.Http.Logging.LoggingScopeHttpMessageHandler.SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)
   --- End of inner exception stack trace ---
   --- End of inner exception stack trace ---
   at System.Net.Http.HttpClient.HandleFailure(Exception e, Boolean telemetryStarted, HttpResponseMessage response, CancellationTokenSource cts, CancellationToken cancellationToken, CancellationTokenSource pendingRequestsCts)
   at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)
   at TgCheckerApi.Job.UpdateSubscribersJob.Execute(IJobExecutionContext context) in C:\Users\79103\Source\Repos\goldman2g5\TgCheckerApi4.1\TgCheckerApi\Job\UpdateSubscribersJob.cs:line 49
2024-04-04 18:16:02.693 +03:00 [INF] User profile is available. Using 'C:\Users\79103\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-04-04 18:16:02.968 +03:00 [INF] Default Quartz.NET properties loaded from embedded resource file
2024-04-04 18:16:03.019 +03:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2024-04-04 18:16:03.019 +03:00 [INF] Quartz Scheduler created
2024-04-04 18:16:03.020 +03:00 [INF] RAMJobStore initialized.
2024-04-04 18:16:03.022 +03:00 [INF] Quartz Scheduler 3.8.0.0 - 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2024-04-04 18:16:03.023 +03:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2024-04-04 18:16:03.024 +03:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2024-04-04 18:16:03.026 +03:00 [INF] JobFactory set to: TgCheckerApi.Quartz.QuartzJobFactory
2024-04-04 18:16:03.103 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-04-04 18:16:03.209 +03:00 [INF] JobFactory set to: TgCheckerApi.Quartz.QuartzJobFactory
2024-04-04 18:16:03.210 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-04-04 18:16:03.256 +03:00 [INF] LoadDelayedNotificationsJob started at "2024-04-04T18:16:03.2471501+03:00"
2024-04-04 18:16:03.256 +03:00 [INF] RecalculateTopPosJob started at "2024-04-04T18:16:03.2536982+03:00"
2024-04-04 18:16:04.990 +03:00 [INF] Executed DbCommand (60ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT n.id, n.channel_id, n.content, n.content_type, n.date, n.target_telegram, n.type_id, n.user_id
FROM "NotificationDelayedTask" AS n
2024-04-04 18:16:04.990 +03:00 [INF] Executed DbCommand (61ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c.tgclient_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
ORDER BY c.bumps DESC
2024-04-04 18:16:05.032 +03:00 [INF] All NotificationDelayedTasks are loaded and scheduled.
2024-04-04 18:16:05.237 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32), @p3='?' (DbType = Int32), @p2='?' (DbType = Int32), @p5='?' (DbType = Int32), @p4='?' (DbType = Int32), @p7='?' (DbType = Int32), @p6='?' (DbType = Int32), @p9='?' (DbType = Int32), @p8='?' (DbType = Int32), @p11='?' (DbType = Int32), @p10='?' (DbType = Int32), @p13='?' (DbType = Int32), @p12='?' (DbType = Int32), @p15='?' (DbType = Int32), @p14='?' (DbType = Int32), @p17='?' (DbType = Int32), @p16='?' (DbType = Int32), @p19='?' (DbType = Int32), @p18='?' (DbType = Int32), @p21='?' (DbType = Int32), @p20='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Channel" SET "TopPos" = @p0
WHERE id = @p1;
UPDATE "Channel" SET "TopPos" = @p2
WHERE id = @p3;
UPDATE "Channel" SET "TopPos" = @p4
WHERE id = @p5;
UPDATE "Channel" SET "TopPos" = @p6
WHERE id = @p7;
UPDATE "Channel" SET "TopPos" = @p8
WHERE id = @p9;
UPDATE "Channel" SET "TopPos" = @p10
WHERE id = @p11;
UPDATE "Channel" SET "TopPos" = @p12
WHERE id = @p13;
UPDATE "Channel" SET "TopPos" = @p14
WHERE id = @p15;
UPDATE "Channel" SET "TopPos" = @p16
WHERE id = @p17;
UPDATE "Channel" SET "TopPos" = @p18
WHERE id = @p19;
UPDATE "Channel" SET "TopPos" = @p20
WHERE id = @p21;
2024-04-04 18:16:05.289 +03:00 [INF] RecalculateTopPosJob completed at "2024-04-04T18:16:05.2895193+03:00"
2024-04-04 18:16:07.999 +03:00 [INF] Now listening on: http://localhost:7256
2024-04-04 18:16:08.000 +03:00 [INF] Now listening on: http://localhost:5244
2024-04-04 18:16:08.002 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-04-04 18:16:08.003 +03:00 [INF] Hosting environment: Development
2024-04-04 18:16:08.004 +03:00 [INF] Content root path: C:\Users\79103\Source\Repos\goldman2g5\TgCheckerApi4.1\TgCheckerApi\
2024-04-04 18:16:08.519 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/index.html - -
2024-04-04 18:16:08.790 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/index.html - - - 200 - text/html;charset=utf-8 278.2474ms
2024-04-04 18:16:08.805 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - -
2024-04-04 18:16:08.807 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_vs/browserLink - -
2024-04-04 18:16:08.812 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - - - 200 12356 application/javascript;+charset=utf-8 6.8484ms
2024-04-04 18:16:08.841 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 34.2368ms
2024-04-04 18:16:08.903 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - -
2024-04-04 18:16:09.066 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 162.7484ms
2024-04-04 18:16:13.391 +03:00 [INF] Start processing HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-04-04 18:16:13.394 +03:00 [INF] Sending HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-04-04 18:16:55.328 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=-1001748293344&startDate=04.04.2024&endDate=03.04.2024 - -
2024-04-04 18:16:55.339 +03:00 [WRN] Failed to determine the https port for redirect.
2024-04-04 18:16:55.450 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:16:55.490 +03:00 [INF] Route matched with {action = "GetMessagesByPeriod", controller = "Telegram"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByPeriodAsync(Int64, System.DateTime, System.DateTime) on controller TgCheckerApi.Controllers.TelegramController (TgCheckerApi).
2024-04-04 18:16:56.102 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.OrderedEnumerable`2[[<>f__AnonymousType10`3[[System.Int32, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-04-04 18:16:56.139 +03:00 [INF] Executed action TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi) in 639.9508ms
2024-04-04 18:16:56.144 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:16:56.150 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=-1001748293344&startDate=04.04.2024&endDate=03.04.2024 - - - 200 2 application/json;+charset=utf-8 821.9649ms
2024-04-04 18:17:07.576 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=-1001748293344&startDate=03.04.2024&endDate=04.04.2024 - -
2024-04-04 18:17:07.583 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:17:07.585 +03:00 [INF] Route matched with {action = "GetMessagesByPeriod", controller = "Telegram"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByPeriodAsync(Int64, System.DateTime, System.DateTime) on controller TgCheckerApi.Controllers.TelegramController (TgCheckerApi).
2024-04-04 18:17:53.461 +03:00 [ERR] Error occurred executing UpdateSubscribersJob via HTTP request.
System.Threading.Tasks.TaskCanceledException: The request was canceled due to the configured HttpClient.Timeout of 100 seconds elapsing.
 ---> System.TimeoutException: The operation was canceled.
 ---> System.Threading.Tasks.TaskCanceledException: The operation was canceled.
 ---> System.IO.IOException: Unable to read data from the transport connection: The I/O operation has been aborted because of either a thread exit or an application request..
 ---> System.Net.Sockets.SocketException (995): The I/O operation has been aborted because of either a thread exit or an application request.
   --- End of inner exception stack trace ---
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource<System.Int32>.GetResult(Int16 token)
   at System.Net.Security.SslStream.EnsureFullTlsFrameAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ReadAsyncInternal[TIOAdapter](TIOAdapter adapter, Memory`1 buffer)
   at System.Net.Http.HttpConnection.InitialFillAsync(Boolean async)
   at System.Net.Http.HttpConnection.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.HttpConnection.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithVersionDetectionAndRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at Microsoft.Extensions.Http.Logging.LoggingHttpMessageHandler.SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)
   at Microsoft.Extensions.Http.Logging.LoggingScopeHttpMessageHandler.SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)
   --- End of inner exception stack trace ---
   --- End of inner exception stack trace ---
   at System.Net.Http.HttpClient.HandleFailure(Exception e, Boolean telemetryStarted, HttpResponseMessage response, CancellationTokenSource cts, CancellationToken cancellationToken, CancellationTokenSource pendingRequestsCts)
   at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)
   at TgCheckerApi.Job.UpdateSubscribersJob.Execute(IJobExecutionContext context) in C:\Users\79103\Source\Repos\goldman2g5\TgCheckerApi4.1\TgCheckerApi\Job\UpdateSubscribersJob.cs:line 49
2024-04-04 18:18:17.717 +03:00 [INF] User profile is available. Using 'C:\Users\79103\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-04-04 18:18:18.035 +03:00 [INF] Default Quartz.NET properties loaded from embedded resource file
2024-04-04 18:18:18.095 +03:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2024-04-04 18:18:18.095 +03:00 [INF] Quartz Scheduler created
2024-04-04 18:18:18.096 +03:00 [INF] RAMJobStore initialized.
2024-04-04 18:18:18.098 +03:00 [INF] Quartz Scheduler 3.8.0.0 - 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2024-04-04 18:18:18.099 +03:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2024-04-04 18:18:18.099 +03:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2024-04-04 18:18:18.101 +03:00 [INF] JobFactory set to: TgCheckerApi.Quartz.QuartzJobFactory
2024-04-04 18:18:18.181 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-04-04 18:18:18.320 +03:00 [INF] JobFactory set to: TgCheckerApi.Quartz.QuartzJobFactory
2024-04-04 18:18:18.321 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-04-04 18:18:18.384 +03:00 [INF] RecalculateTopPosJob started at "2024-04-04T18:18:18.3812366+03:00"
2024-04-04 18:18:18.384 +03:00 [INF] LoadDelayedNotificationsJob started at "2024-04-04T18:18:18.3741200+03:00"
2024-04-04 18:18:20.618 +03:00 [INF] Executed DbCommand (138ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT n.id, n.channel_id, n.content, n.content_type, n.date, n.target_telegram, n.type_id, n.user_id
FROM "NotificationDelayedTask" AS n
2024-04-04 18:18:20.618 +03:00 [INF] Executed DbCommand (139ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c.tgclient_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
ORDER BY c.bumps DESC
2024-04-04 18:18:20.686 +03:00 [INF] All NotificationDelayedTasks are loaded and scheduled.
2024-04-04 18:18:21.010 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32), @p3='?' (DbType = Int32), @p2='?' (DbType = Int32), @p5='?' (DbType = Int32), @p4='?' (DbType = Int32), @p7='?' (DbType = Int32), @p6='?' (DbType = Int32), @p9='?' (DbType = Int32), @p8='?' (DbType = Int32), @p11='?' (DbType = Int32), @p10='?' (DbType = Int32), @p13='?' (DbType = Int32), @p12='?' (DbType = Int32), @p15='?' (DbType = Int32), @p14='?' (DbType = Int32), @p17='?' (DbType = Int32), @p16='?' (DbType = Int32), @p19='?' (DbType = Int32), @p18='?' (DbType = Int32), @p21='?' (DbType = Int32), @p20='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Channel" SET "TopPos" = @p0
WHERE id = @p1;
UPDATE "Channel" SET "TopPos" = @p2
WHERE id = @p3;
UPDATE "Channel" SET "TopPos" = @p4
WHERE id = @p5;
UPDATE "Channel" SET "TopPos" = @p6
WHERE id = @p7;
UPDATE "Channel" SET "TopPos" = @p8
WHERE id = @p9;
UPDATE "Channel" SET "TopPos" = @p10
WHERE id = @p11;
UPDATE "Channel" SET "TopPos" = @p12
WHERE id = @p13;
UPDATE "Channel" SET "TopPos" = @p14
WHERE id = @p15;
UPDATE "Channel" SET "TopPos" = @p16
WHERE id = @p17;
UPDATE "Channel" SET "TopPos" = @p18
WHERE id = @p19;
UPDATE "Channel" SET "TopPos" = @p20
WHERE id = @p21;
2024-04-04 18:18:21.105 +03:00 [INF] RecalculateTopPosJob completed at "2024-04-04T18:18:21.1050109+03:00"
2024-04-04 18:18:23.988 +03:00 [INF] Now listening on: http://localhost:7256
2024-04-04 18:18:23.989 +03:00 [INF] Now listening on: http://localhost:5244
2024-04-04 18:18:23.991 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-04-04 18:18:23.992 +03:00 [INF] Hosting environment: Development
2024-04-04 18:18:23.993 +03:00 [INF] Content root path: C:\Users\79103\Source\Repos\goldman2g5\TgCheckerApi4.1\TgCheckerApi\
2024-04-04 18:18:24.413 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/index.html - -
2024-04-04 18:18:24.779 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/index.html - - - 200 - text/html;charset=utf-8 377.0513ms
2024-04-04 18:18:24.800 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - -
2024-04-04 18:18:24.804 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_vs/browserLink - -
2024-04-04 18:18:24.810 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - - - 200 12356 application/javascript;+charset=utf-8 9.4880ms
2024-04-04 18:18:24.855 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 50.7096ms
2024-04-04 18:18:24.938 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - -
2024-04-04 18:18:25.287 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 349.4443ms
2024-04-04 18:18:28.581 +03:00 [INF] Start processing HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-04-04 18:18:28.588 +03:00 [INF] Sending HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-04-04 18:20:08.643 +03:00 [ERR] Error occurred executing UpdateSubscribersJob via HTTP request.
System.Threading.Tasks.TaskCanceledException: The request was canceled due to the configured HttpClient.Timeout of 100 seconds elapsing.
 ---> System.TimeoutException: The operation was canceled.
 ---> System.Threading.Tasks.TaskCanceledException: The operation was canceled.
 ---> System.IO.IOException: Unable to read data from the transport connection: The I/O operation has been aborted because of either a thread exit or an application request..
 ---> System.Net.Sockets.SocketException (995): The I/O operation has been aborted because of either a thread exit or an application request.
   --- End of inner exception stack trace ---
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource<System.Int32>.GetResult(Int16 token)
   at System.Net.Security.SslStream.EnsureFullTlsFrameAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ReadAsyncInternal[TIOAdapter](TIOAdapter adapter, Memory`1 buffer)
   at System.Net.Http.HttpConnection.InitialFillAsync(Boolean async)
   at System.Net.Http.HttpConnection.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.HttpConnection.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithVersionDetectionAndRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at Microsoft.Extensions.Http.Logging.LoggingHttpMessageHandler.SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)
   at Microsoft.Extensions.Http.Logging.LoggingScopeHttpMessageHandler.SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)
   --- End of inner exception stack trace ---
   --- End of inner exception stack trace ---
   at System.Net.Http.HttpClient.HandleFailure(Exception e, Boolean telemetryStarted, HttpResponseMessage response, CancellationTokenSource cts, CancellationToken cancellationToken, CancellationTokenSource pendingRequestsCts)
   at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)
   at TgCheckerApi.Job.UpdateSubscribersJob.Execute(IJobExecutionContext context) in C:\Users\79103\Source\Repos\goldman2g5\TgCheckerApi4.1\TgCheckerApi\Job\UpdateSubscribersJob.cs:line 49
2024-04-04 18:20:11.475 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?startDate=04.04.2024&endDate=03.04.2024 - -
2024-04-04 18:20:11.494 +03:00 [WRN] Failed to determine the https port for redirect.
2024-04-04 18:20:11.664 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:20:11.702 +03:00 [INF] Route matched with {action = "GetMessagesByPeriod", controller = "Telegram"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByPeriodAsync(Int64, System.DateTime, System.DateTime) on controller TgCheckerApi.Controllers.TelegramController (TgCheckerApi).
2024-04-04 18:20:11.760 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'System.String'.
2024-04-04 18:20:11.768 +03:00 [INF] Executed action TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi) in 58.3307ms
2024-04-04 18:20:11.772 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:20:11.777 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?startDate=04.04.2024&endDate=03.04.2024 - - - 404 - text/plain;+charset=utf-8 302.2251ms
2024-04-04 18:20:18.728 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=-1001748293344&startDate=04.04.2024&endDate=03.04.2024 - -
2024-04-04 18:20:18.732 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:20:18.734 +03:00 [INF] Route matched with {action = "GetMessagesByPeriod", controller = "Telegram"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByPeriodAsync(Int64, System.DateTime, System.DateTime) on controller TgCheckerApi.Controllers.TelegramController (TgCheckerApi).
2024-04-04 18:20:19.311 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.OrderedEnumerable`2[[<>f__AnonymousType10`3[[System.Int32, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-04-04 18:20:19.338 +03:00 [INF] Executed action TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi) in 595.7593ms
2024-04-04 18:20:19.341 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:20:19.342 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=-1001748293344&startDate=04.04.2024&endDate=03.04.2024 - - - 200 2 application/json;+charset=utf-8 614.6496ms
2024-04-04 18:20:26.860 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=-1001748293344&startDate=03.04.2024&endDate=04.04.2024 - -
2024-04-04 18:20:26.865 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:20:26.866 +03:00 [INF] Route matched with {action = "GetMessagesByPeriod", controller = "Telegram"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByPeriodAsync(Int64, System.DateTime, System.DateTime) on controller TgCheckerApi.Controllers.TelegramController (TgCheckerApi).
2024-04-04 18:25:23.794 +03:00 [INF] User profile is available. Using 'C:\Users\79103\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-04-04 18:25:24.099 +03:00 [INF] Default Quartz.NET properties loaded from embedded resource file
2024-04-04 18:25:24.162 +03:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2024-04-04 18:25:24.163 +03:00 [INF] Quartz Scheduler created
2024-04-04 18:25:24.164 +03:00 [INF] RAMJobStore initialized.
2024-04-04 18:25:24.165 +03:00 [INF] Quartz Scheduler 3.8.0.0 - 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2024-04-04 18:25:24.166 +03:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2024-04-04 18:25:24.167 +03:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2024-04-04 18:25:24.168 +03:00 [INF] JobFactory set to: TgCheckerApi.Quartz.QuartzJobFactory
2024-04-04 18:25:24.226 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-04-04 18:25:24.321 +03:00 [INF] JobFactory set to: TgCheckerApi.Quartz.QuartzJobFactory
2024-04-04 18:25:24.321 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-04-04 18:25:24.369 +03:00 [INF] RecalculateTopPosJob started at "2024-04-04T18:25:24.3672438+03:00"
2024-04-04 18:25:24.369 +03:00 [INF] LoadDelayedNotificationsJob started at "2024-04-04T18:25:24.3615064+03:00"
2024-04-04 18:25:26.296 +03:00 [INF] Executed DbCommand (67ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c.tgclient_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
ORDER BY c.bumps DESC
2024-04-04 18:25:26.296 +03:00 [INF] Executed DbCommand (66ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT n.id, n.channel_id, n.content, n.content_type, n.date, n.target_telegram, n.type_id, n.user_id
FROM "NotificationDelayedTask" AS n
2024-04-04 18:25:26.341 +03:00 [INF] All NotificationDelayedTasks are loaded and scheduled.
2024-04-04 18:25:26.578 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32), @p3='?' (DbType = Int32), @p2='?' (DbType = Int32), @p5='?' (DbType = Int32), @p4='?' (DbType = Int32), @p7='?' (DbType = Int32), @p6='?' (DbType = Int32), @p9='?' (DbType = Int32), @p8='?' (DbType = Int32), @p11='?' (DbType = Int32), @p10='?' (DbType = Int32), @p13='?' (DbType = Int32), @p12='?' (DbType = Int32), @p15='?' (DbType = Int32), @p14='?' (DbType = Int32), @p17='?' (DbType = Int32), @p16='?' (DbType = Int32), @p19='?' (DbType = Int32), @p18='?' (DbType = Int32), @p21='?' (DbType = Int32), @p20='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Channel" SET "TopPos" = @p0
WHERE id = @p1;
UPDATE "Channel" SET "TopPos" = @p2
WHERE id = @p3;
UPDATE "Channel" SET "TopPos" = @p4
WHERE id = @p5;
UPDATE "Channel" SET "TopPos" = @p6
WHERE id = @p7;
UPDATE "Channel" SET "TopPos" = @p8
WHERE id = @p9;
UPDATE "Channel" SET "TopPos" = @p10
WHERE id = @p11;
UPDATE "Channel" SET "TopPos" = @p12
WHERE id = @p13;
UPDATE "Channel" SET "TopPos" = @p14
WHERE id = @p15;
UPDATE "Channel" SET "TopPos" = @p16
WHERE id = @p17;
UPDATE "Channel" SET "TopPos" = @p18
WHERE id = @p19;
UPDATE "Channel" SET "TopPos" = @p20
WHERE id = @p21;
2024-04-04 18:25:26.655 +03:00 [INF] RecalculateTopPosJob completed at "2024-04-04T18:25:26.6550733+03:00"
2024-04-04 18:25:29.471 +03:00 [INF] Now listening on: http://localhost:7256
2024-04-04 18:25:29.472 +03:00 [INF] Now listening on: http://localhost:5244
2024-04-04 18:25:29.474 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-04-04 18:25:29.475 +03:00 [INF] Hosting environment: Development
2024-04-04 18:25:29.475 +03:00 [INF] Content root path: C:\Users\79103\Source\Repos\goldman2g5\TgCheckerApi4.1\TgCheckerApi\
2024-04-04 18:25:29.817 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/index.html - -
2024-04-04 18:25:30.076 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/index.html - - - 200 - text/html;charset=utf-8 266.3095ms
2024-04-04 18:25:30.092 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - -
2024-04-04 18:25:30.093 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_vs/browserLink - -
2024-04-04 18:25:30.099 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - - - 200 12356 application/javascript;+charset=utf-8 6.8636ms
2024-04-04 18:25:30.122 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 28.4582ms
2024-04-04 18:25:30.220 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - -
2024-04-04 18:25:30.393 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 172.3723ms
2024-04-04 18:25:34.463 +03:00 [INF] Start processing HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-04-04 18:25:34.467 +03:00 [INF] Sending HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-04-04 18:25:51.958 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=-1001748293344&startDate=04.04.2024&endDate=03.04.2024 - -
2024-04-04 18:25:51.965 +03:00 [WRN] Failed to determine the https port for redirect.
2024-04-04 18:25:52.086 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:25:52.118 +03:00 [INF] Route matched with {action = "GetMessagesByPeriod", controller = "Telegram"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByPeriodAsync(Int64, System.DateTime, System.DateTime) on controller TgCheckerApi.Controllers.TelegramController (TgCheckerApi).
2024-04-04 18:25:52.812 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.OrderedEnumerable`2[[<>f__AnonymousType10`3[[System.Int32, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-04-04 18:25:52.845 +03:00 [INF] Executed action TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi) in 717.2079ms
2024-04-04 18:25:52.850 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:25:52.857 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=-1001748293344&startDate=04.04.2024&endDate=03.04.2024 - - - 200 2 application/json;+charset=utf-8 898.9965ms
2024-04-04 18:25:57.505 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=-1001748293344&startDate=03.04.2024&endDate=04.04.2024 - -
2024-04-04 18:25:57.510 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:25:57.511 +03:00 [INF] Route matched with {action = "GetMessagesByPeriod", controller = "Telegram"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByPeriodAsync(Int64, System.DateTime, System.DateTime) on controller TgCheckerApi.Controllers.TelegramController (TgCheckerApi).
2024-04-04 18:26:00.479 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.OrderedEnumerable`2[[<>f__AnonymousType10`3[[System.Int32, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-04-04 18:26:00.506 +03:00 [INF] Executed action TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi) in 2992.6025ms
2024-04-04 18:26:00.509 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:26:00.510 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=-1001748293344&startDate=03.04.2024&endDate=04.04.2024 - - - 200 41609 application/json;+charset=utf-8 3004.7691ms
2024-04-04 18:26:55.487 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=-1001748293344&startDate=04.03.2024&endDate=04.04.2024 - -
2024-04-04 18:26:55.493 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:26:55.494 +03:00 [INF] Route matched with {action = "GetMessagesByPeriod", controller = "Telegram"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByPeriodAsync(Int64, System.DateTime, System.DateTime) on controller TgCheckerApi.Controllers.TelegramController (TgCheckerApi).
2024-04-04 18:26:56.193 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.OrderedEnumerable`2[[<>f__AnonymousType10`3[[System.Int32, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-04-04 18:26:56.196 +03:00 [INF] Executed action TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi) in 697.0872ms
2024-04-04 18:26:56.198 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.TelegramController.GetMessagesByPeriodAsync (TgCheckerApi)'
2024-04-04 18:26:56.199 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/api/Telegram/GetMessagesByPeriod?channelId=-1001748293344&startDate=04.03.2024&endDate=04.04.2024 - - - 200 1345 application/json;+charset=utf-8 711.9872ms
2024-04-04 18:27:14.564 +03:00 [ERR] Error occurred executing UpdateSubscribersJob via HTTP request.
System.Threading.Tasks.TaskCanceledException: The request was canceled due to the configured HttpClient.Timeout of 100 seconds elapsing.
 ---> System.TimeoutException: The operation was canceled.
 ---> System.Threading.Tasks.TaskCanceledException: The operation was canceled.
 ---> System.IO.IOException: Unable to read data from the transport connection: The I/O operation has been aborted because of either a thread exit or an application request..
 ---> System.Net.Sockets.SocketException (995): The I/O operation has been aborted because of either a thread exit or an application request.
   --- End of inner exception stack trace ---
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource<System.Int32>.GetResult(Int16 token)
   at System.Net.Security.SslStream.EnsureFullTlsFrameAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ReadAsyncInternal[TIOAdapter](TIOAdapter adapter, Memory`1 buffer)
   at System.Net.Http.HttpConnection.InitialFillAsync(Boolean async)
   at System.Net.Http.HttpConnection.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at System.Net.Http.HttpConnection.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at System.Net.Http.HttpConnectionPool.SendWithVersionDetectionAndRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)
   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)
   at Microsoft.Extensions.Http.Logging.LoggingHttpMessageHandler.SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)
   at Microsoft.Extensions.Http.Logging.LoggingScopeHttpMessageHandler.SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)
   at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)
   --- End of inner exception stack trace ---
   --- End of inner exception stack trace ---
   at System.Net.Http.HttpClient.HandleFailure(Exception e, Boolean telemetryStarted, HttpResponseMessage response, CancellationTokenSource cts, CancellationToken cancellationToken, CancellationTokenSource pendingRequestsCts)
   at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)
   at TgCheckerApi.Job.UpdateSubscribersJob.Execute(IJobExecutionContext context) in C:\Users\79103\Source\Repos\goldman2g5\TgCheckerApi4.1\TgCheckerApi\Job\UpdateSubscribersJob.cs:line 49
