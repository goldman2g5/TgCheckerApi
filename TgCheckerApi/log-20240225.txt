2024-02-25 14:57:48.158 +03:00 [INF] User profile is available. Using 'C:\Users\timar\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-02-25 14:57:48.676 +03:00 [INF] Default Quartz.NET properties loaded from embedded resource file
2024-02-25 14:57:48.726 +03:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2024-02-25 14:57:48.727 +03:00 [INF] Quartz Scheduler created
2024-02-25 14:57:48.728 +03:00 [INF] RAMJobStore initialized.
2024-02-25 14:57:48.729 +03:00 [INF] Quartz Scheduler 3.8.0.0 - 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2024-02-25 14:57:48.730 +03:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2024-02-25 14:57:48.730 +03:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2024-02-25 14:57:48.731 +03:00 [INF] JobFactory set to: TgCheckerApi.Job.QuartzJobFactory
2024-02-25 14:57:48.787 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-02-25 14:57:49.009 +03:00 [INF] Now listening on: https://localhost:7256
2024-02-25 14:57:49.009 +03:00 [INF] Now listening on: https://localhost:5244
2024-02-25 14:57:49.013 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-02-25 14:57:49.014 +03:00 [INF] Hosting environment: Development
2024-02-25 14:57:49.014 +03:00 [INF] Content root path: C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\
2024-02-25 14:57:49.078 +03:00 [INF] RecalculateTopPosJob started at "2024-02-25T14:57:49.0776772+03:00"
2024-02-25 14:57:50.359 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/swagger - -
2024-02-25 14:57:50.424 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/swagger - - - 301 0 - 68.4306ms
2024-02-25 14:57:50.427 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/swagger/index.html - -
2024-02-25 14:57:50.744 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/swagger/index.html - - - 200 - text/html;charset=utf-8 317.4434ms
2024-02-25 14:57:50.747 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/swagger/swagger-ui-bundle.js - -
2024-02-25 14:57:50.747 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/_framework/aspnetcore-browser-refresh.js - -
2024-02-25 14:57:50.747 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/swagger/swagger-ui-standalone-preset.js - -
2024-02-25 14:57:50.748 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/swagger/swagger-ui.css - -
2024-02-25 14:57:50.753 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/_framework/aspnetcore-browser-refresh.js - - - 200 12356 application/javascript;+charset=utf-8 5.7390ms
2024-02-25 14:57:50.757 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/_vs/browserLink - -
2024-02-25 14:57:50.806 +03:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2024-02-25 14:57:50.807 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/swagger/swagger-ui.css - - - 200 144929 text/css 59.6508ms
2024-02-25 14:57:50.814 +03:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2024-02-25 14:57:50.817 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/swagger/swagger-ui-standalone-preset.js - - - 200 312163 application/javascript 69.7346ms
2024-02-25 14:57:50.838 +03:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2024-02-25 14:57:50.839 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/swagger/swagger-ui-bundle.js - - - 200 1061536 application/javascript 91.8321ms
2024-02-25 14:57:50.898 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 142.1777ms
2024-02-25 14:57:50.940 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/swagger/v1/swagger.json - -
2024-02-25 14:57:50.991 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/swagger/favicon-32x32.png - -
2024-02-25 14:57:50.992 +03:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2024-02-25 14:57:50.993 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/swagger/favicon-32x32.png - - - 200 628 image/png 2.1121ms
2024-02-25 14:57:51.200 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 260.6417ms
2024-02-25 14:57:52.412 +03:00 [INF] Executed DbCommand (189ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
ORDER BY c.bumps DESC
2024-02-25 14:57:53.026 +03:00 [INF] Executed DbCommand (288ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32), @p3='?' (DbType = Int32), @p2='?' (DbType = Int32), @p5='?' (DbType = Int32), @p4='?' (DbType = Int32), @p7='?' (DbType = Int32), @p6='?' (DbType = Int32), @p9='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Channel" SET "TopPos" = @p0
WHERE id = @p1;
UPDATE "Channel" SET "TopPos" = @p2
WHERE id = @p3;
UPDATE "Channel" SET "TopPos" = @p4
WHERE id = @p5;
UPDATE "Channel" SET "TopPos" = @p6
WHERE id = @p7;
UPDATE "Channel" SET "TopPos" = @p8
WHERE id = @p9;
2024-02-25 14:57:53.065 +03:00 [INF] RecalculateTopPosJob completed at "2024-02-25T14:57:53.0656252+03:00"
2024-02-25 14:57:58.977 +03:00 [INF] Start processing HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 14:57:58.979 +03:00 [INF] Sending HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 14:57:59.400 +03:00 [INF] Received HTTP response headers after 417.0681ms - 200
2024-02-25 14:57:59.403 +03:00 [INF] End processing HTTP request after 429.3881ms - 200
2024-02-25 14:57:59.406 +03:00 [INF] Successfully processed all channels via HTTP request at: {DateTime.UtcNow}
2024-02-25 15:00:57.160 +03:00 [INF] User profile is available. Using 'C:\Users\timar\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-02-25 15:00:57.326 +03:00 [INF] Default Quartz.NET properties loaded from embedded resource file
2024-02-25 15:00:57.364 +03:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2024-02-25 15:00:57.367 +03:00 [INF] Quartz Scheduler created
2024-02-25 15:00:57.368 +03:00 [INF] RAMJobStore initialized.
2024-02-25 15:00:57.369 +03:00 [INF] Quartz Scheduler 3.8.0.0 - 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2024-02-25 15:00:57.369 +03:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2024-02-25 15:00:57.370 +03:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2024-02-25 15:00:57.371 +03:00 [INF] JobFactory set to: TgCheckerApi.Job.QuartzJobFactory
2024-02-25 15:00:57.413 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-02-25 15:00:57.518 +03:00 [INF] Now listening on: http://localhost:7256
2024-02-25 15:00:57.519 +03:00 [INF] Now listening on: http://localhost:5244
2024-02-25 15:00:57.522 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-02-25 15:00:57.523 +03:00 [INF] Hosting environment: Development
2024-02-25 15:00:57.524 +03:00 [INF] Content root path: C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\
2024-02-25 15:00:57.598 +03:00 [INF] RecalculateTopPosJob started at "2024-02-25T15:00:57.5983345+03:00"
2024-02-25 15:00:58.099 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger - -
2024-02-25 15:00:58.163 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger - - - 301 0 - 70.3935ms
2024-02-25 15:00:58.171 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/index.html - -
2024-02-25 15:00:58.380 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/swagger-ui.css - -
2024-02-25 15:00:58.380 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/swagger-ui-bundle.js - -
2024-02-25 15:00:58.381 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/swagger-ui-standalone-preset.js - -
2024-02-25 15:00:58.384 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/index.html - - - 200 - text/html;charset=utf-8 213.0333ms
2024-02-25 15:00:58.388 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_vs/browserLink - -
2024-02-25 15:00:58.391 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - -
2024-02-25 15:00:58.395 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - - - 200 12356 application/javascript;+charset=utf-8 4.8293ms
2024-02-25 15:00:58.421 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 32.9806ms
2024-02-25 15:00:58.422 +03:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2024-02-25 15:00:58.422 +03:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2024-02-25 15:00:58.422 +03:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2024-02-25 15:00:58.423 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/swagger-ui.css - - - 200 144929 text/css 42.6957ms
2024-02-25 15:00:58.424 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/swagger-ui-standalone-preset.js - - - 200 312163 application/javascript 43.7565ms
2024-02-25 15:00:58.425 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/swagger-ui-bundle.js - - - 200 1061536 application/javascript 44.6222ms
2024-02-25 15:00:58.530 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - -
2024-02-25 15:00:58.541 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/favicon-32x32.png - -
2024-02-25 15:00:58.542 +03:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2024-02-25 15:00:58.543 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/favicon-32x32.png - - - 200 628 image/png 2.1061ms
2024-02-25 15:00:58.653 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 123.4429ms
2024-02-25 15:00:59.414 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
ORDER BY c.bumps DESC
2024-02-25 15:00:59.580 +03:00 [INF] RecalculateTopPosJob completed at "2024-02-25T15:00:59.5802720+03:00"
2024-02-25 15:01:04.915 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:7256/BotHub/negotiate?negotiateVersion=0 - 0
2024-02-25 15:01:04.922 +03:00 [WRN] Failed to determine the https port for redirect.
2024-02-25 15:01:05.033 +03:00 [INF] Executing endpoint '/BotHub/negotiate'
2024-02-25 15:01:05.057 +03:00 [INF] Executed endpoint '/BotHub/negotiate'
2024-02-25 15:01:05.059 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:7256/BotHub/negotiate?negotiateVersion=0 - 0 - 200 273 application/json 143.6146ms
2024-02-25 15:01:05.069 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/BotHub?id=KYulJEYiJslrvNg0bT84Mw - -
2024-02-25 15:01:05.071 +03:00 [INF] Executing endpoint '/BotHub'
2024-02-25 15:01:07.605 +03:00 [INF] Start processing HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:01:07.609 +03:00 [INF] Sending HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:01:25.931 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:7256/api/Bot/getDailyViewsByChannel application/json-patch+json 43
2024-02-25 15:01:25.941 +03:00 [INF] CORS policy execution successful.
2024-02-25 15:01:25.946 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.BotController.CallGetDailyViewsByChannel (TgCheckerApi)'
2024-02-25 15:01:25.982 +03:00 [INF] Route matched with {action = "CallGetDailyViewsByChannel", controller = "Bot"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CallGetDailyViewsByChannel(DailyViewsRequest) on controller TgCheckerApi.Controllers.BotController (TgCheckerApi).
2024-02-25 15:01:26.075 +03:00 [INF] Starting CallGetDailyViewsByChannel method for ChannelId: 80
2024-02-25 15:01:26.076 +03:00 [INF] Adjusted NumberOfDays to 29 for the current month.
2024-02-25 15:01:26.216 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
WHERE c.id = @__p_0
LIMIT 1
2024-02-25 15:01:26.434 +03:00 [INF] Executed DbCommand (71ms) [Parameters=[@__dailyViewsRequest_ChannelId_0='?' (DbType = Int32), @__startDate_1='?' (DbType = DateTime), @__endDate_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT v.id, v.date, v.last_message_id, v.sheet, v.updated, v.views
FROM "Channel" AS c
INNER JOIN "StatisticsSheet" AS s ON c.id = s.channel_id
INNER JOIN "ViewsRecord" AS v ON s.id = v.sheet
WHERE c.id = @__dailyViewsRequest_ChannelId_0 AND v.date >= @__startDate_1 AND v.date <= @__endDate_2
ORDER BY v.date
2024-02-25 15:01:26.454 +03:00 [INF] Starting IsUpdateRequiredForChannel method.
2024-02-25 15:01:26.455 +03:00 [INF] Parameters: ChannelId=80, NumberOfDays=29
2024-02-25 15:01:26.456 +03:00 [INF] Outdated threshold set to 360 minutes.
2024-02-25 15:01:26.462 +03:00 [INF] Checking records from 1/27/2024 12:00:00 AM to 2/25/2024 12:00:00 AM.
2024-02-25 15:01:26.469 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__dailyViewsRequest_ChannelId_0='?' (DbType = Int32), @__startDate_1='?' (DbType = DateTime), @__today_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT v.id, v.date, v.last_message_id, v.sheet, v.updated, v.views
FROM "Channel" AS c
INNER JOIN "StatisticsSheet" AS s ON c.id = s.channel_id
INNER JOIN "ViewsRecord" AS v ON s.id = v.sheet
WHERE c.id = @__dailyViewsRequest_ChannelId_0 AND v.date >= @__startDate_1 AND v.date <= @__today_2
2024-02-25 15:01:26.471 +03:00 [INF] 14 records found in date range.
2024-02-25 15:01:26.472 +03:00 [INF] Update required: True
2024-02-25 15:01:26.472 +03:00 [INF] Data is incomplete for ChannelId: 80. Awaiting new data from WebSocket.
2024-02-25 15:01:26.486 +03:00 [INF] Received request for getDailyViewsByChannel. Request hash: 994993270c9bedd8e324fd05c3ee27d501685d3662231ca53c6a0e18ceee0b6b
2024-02-25 15:01:41.367 +03:00 [INF] New task completed successfully. Hash: 994993270c9bedd8e324fd05c3ee27d501685d3662231ca53c6a0e18ceee0b6b
2024-02-25 15:01:41.496 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__channelId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t.avatar, t.bumps, t.description, t.flag, t."Hidden", t."IsPartner", t.language, t.last_bump, t.members, t.name, t.notification_sent, t.notifications, t.promo_post, t.promo_post_interval, t.promo_post_last, t.promo_post_sent, t.promo_post_time, t.telegram_id, t."TopPos", t."Url", t."user", s.id, s.channel_id
FROM (
    SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
    FROM "Channel" AS c
    WHERE c.id = @__channelId_0
    LIMIT 1
) AS t
LEFT JOIN "StatisticsSheet" AS s ON t.id = s.channel_id
ORDER BY t.id
2024-02-25 15:01:41.571 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT v.id, v.date, v.last_message_id, v.sheet, v.updated, v.views
FROM "ViewsRecord" AS v
WHERE v.sheet = @__p_0
2024-02-25 15:01:41.844 +03:00 [INF] Executed DbCommand (99ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?' (DbType = Int32), @p5='?' (DbType = Int32), @p3='?' (DbType = DateTime), @p4='?' (DbType = Int32), @p8='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = Int32), @p11='?' (DbType = Int32), @p9='?' (DbType = DateTime), @p10='?' (DbType = Int32), @p14='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?' (DbType = Int32), @p17='?' (DbType = Int32), @p15='?' (DbType = DateTime), @p16='?' (DbType = Int32), @p20='?' (DbType = Int32), @p18='?' (DbType = DateTime), @p19='?' (DbType = Int32), @p23='?' (DbType = Int32), @p21='?' (DbType = DateTime), @p22='?' (DbType = Int32), @p26='?' (DbType = Int32), @p24='?' (DbType = DateTime), @p25='?' (DbType = Int32), @p29='?' (DbType = Int32), @p27='?' (DbType = DateTime), @p28='?' (DbType = Int32), @p32='?' (DbType = Int32), @p30='?' (DbType = DateTime), @p31='?' (DbType = Int32), @p35='?' (DbType = Int32), @p33='?' (DbType = DateTime), @p34='?' (DbType = Int32), @p38='?' (DbType = Int32), @p36='?' (DbType = DateTime), @p37='?' (DbType = Int32), @p39='?' (DbType = DateTime), @p40='?' (DbType = Int64), @p41='?' (DbType = Int32), @p42='?' (DbType = DateTime), @p43='?' (DbType = Int32), @p44='?' (DbType = DateTime), @p45='?' (DbType = Int64), @p46='?' (DbType = Int32), @p47='?' (DbType = DateTime), @p48='?' (DbType = Int32), @p49='?' (DbType = DateTime), @p50='?' (DbType = Int64), @p51='?' (DbType = Int32), @p52='?' (DbType = DateTime), @p53='?' (DbType = Int32), @p54='?' (DbType = DateTime), @p55='?' (DbType = Int64), @p56='?' (DbType = Int32), @p57='?' (DbType = DateTime), @p58='?' (DbType = Int32), @p59='?' (DbType = DateTime), @p60='?' (DbType = Int64), @p61='?' (DbType = Int32), @p62='?' (DbType = DateTime), @p63='?' (DbType = Int32), @p64='?' (DbType = DateTime), @p65='?' (DbType = Int64), @p66='?' (DbType = Int32), @p67='?' (DbType = DateTime), @p68='?' (DbType = Int32), @p69='?' (DbType = DateTime), @p70='?' (DbType = Int64), @p71='?' (DbType = Int32), @p72='?' (DbType = DateTime), @p73='?' (DbType = Int32), @p74='?' (DbType = DateTime), @p75='?' (DbType = Int64), @p76='?' (DbType = Int32), @p77='?' (DbType = DateTime), @p78='?' (DbType = Int32), @p79='?' (DbType = DateTime), @p80='?' (DbType = Int64), @p81='?' (DbType = Int32), @p82='?' (DbType = DateTime), @p83='?' (DbType = Int32), @p84='?' (DbType = DateTime), @p85='?' (DbType = Int64), @p86='?' (DbType = Int32), @p87='?' (DbType = DateTime), @p88='?' (DbType = Int32), @p89='?' (DbType = DateTime), @p90='?' (DbType = Int64), @p91='?' (DbType = Int32), @p92='?' (DbType = DateTime), @p93='?' (DbType = Int32), @p94='?' (DbType = DateTime), @p95='?' (DbType = Int64), @p96='?' (DbType = Int32), @p97='?' (DbType = DateTime), @p98='?' (DbType = Int32), @p99='?' (DbType = DateTime), @p100='?' (DbType = Int64), @p101='?' (DbType = Int32), @p102='?' (DbType = DateTime), @p103='?' (DbType = Int32), @p104='?' (DbType = DateTime), @p105='?' (DbType = Int64), @p106='?' (DbType = Int32), @p107='?' (DbType = DateTime), @p108='?' (DbType = Int32), @p109='?' (DbType = DateTime), @p110='?' (DbType = Int64), @p111='?' (DbType = Int32), @p112='?' (DbType = DateTime), @p113='?' (DbType = Int32), @p114='?' (DbType = DateTime), @p115='?' (DbType = Int64), @p116='?' (DbType = Int32), @p117='?' (DbType = DateTime), @p118='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ViewsRecord" SET updated = @p0, views = @p1
WHERE id = @p2;
UPDATE "ViewsRecord" SET updated = @p3, views = @p4
WHERE id = @p5;
UPDATE "ViewsRecord" SET updated = @p6, views = @p7
WHERE id = @p8;
UPDATE "ViewsRecord" SET updated = @p9, views = @p10
WHERE id = @p11;
UPDATE "ViewsRecord" SET updated = @p12, views = @p13
WHERE id = @p14;
UPDATE "ViewsRecord" SET updated = @p15, views = @p16
WHERE id = @p17;
UPDATE "ViewsRecord" SET updated = @p18, views = @p19
WHERE id = @p20;
UPDATE "ViewsRecord" SET updated = @p21, views = @p22
WHERE id = @p23;
UPDATE "ViewsRecord" SET updated = @p24, views = @p25
WHERE id = @p26;
UPDATE "ViewsRecord" SET updated = @p27, views = @p28
WHERE id = @p29;
UPDATE "ViewsRecord" SET updated = @p30, views = @p31
WHERE id = @p32;
UPDATE "ViewsRecord" SET updated = @p33, views = @p34
WHERE id = @p35;
UPDATE "ViewsRecord" SET updated = @p36, views = @p37
WHERE id = @p38;
INSERT INTO "ViewsRecord" (date, last_message_id, sheet, updated, views)
VALUES (@p39, @p40, @p41, @p42, @p43)
RETURNING id;
INSERT INTO "ViewsRecord" (date, last_message_id, sheet, updated, views)
VALUES (@p44, @p45, @p46, @p47, @p48)
RETURNING id;
INSERT INTO "ViewsRecord" (date, last_message_id, sheet, updated, views)
VALUES (@p49, @p50, @p51, @p52, @p53)
RETURNING id;
INSERT INTO "ViewsRecord" (date, last_message_id, sheet, updated, views)
VALUES (@p54, @p55, @p56, @p57, @p58)
RETURNING id;
INSERT INTO "ViewsRecord" (date, last_message_id, sheet, updated, views)
VALUES (@p59, @p60, @p61, @p62, @p63)
RETURNING id;
INSERT INTO "ViewsRecord" (date, last_message_id, sheet, updated, views)
VALUES (@p64, @p65, @p66, @p67, @p68)
RETURNING id;
INSERT INTO "ViewsRecord" (date, last_message_id, sheet, updated, views)
VALUES (@p69, @p70, @p71, @p72, @p73)
RETURNING id;
INSERT INTO "ViewsRecord" (date, last_message_id, sheet, updated, views)
VALUES (@p74, @p75, @p76, @p77, @p78)
RETURNING id;
INSERT INTO "ViewsRecord" (date, last_message_id, sheet, updated, views)
VALUES (@p79, @p80, @p81, @p82, @p83)
RETURNING id;
INSERT INTO "ViewsRecord" (date, last_message_id, sheet, updated, views)
VALUES (@p84, @p85, @p86, @p87, @p88)
RETURNING id;
INSERT INTO "ViewsRecord" (date, last_message_id, sheet, updated, views)
VALUES (@p89, @p90, @p91, @p92, @p93)
RETURNING id;
INSERT INTO "ViewsRecord" (date, last_message_id, sheet, updated, views)
VALUES (@p94, @p95, @p96, @p97, @p98)
RETURNING id;
INSERT INTO "ViewsRecord" (date, last_message_id, sheet, updated, views)
VALUES (@p99, @p100, @p101, @p102, @p103)
RETURNING id;
INSERT INTO "ViewsRecord" (date, last_message_id, sheet, updated, views)
VALUES (@p104, @p105, @p106, @p107, @p108)
RETURNING id;
INSERT INTO "ViewsRecord" (date, last_message_id, sheet, updated, views)
VALUES (@p109, @p110, @p111, @p112, @p113)
RETURNING id;
INSERT INTO "ViewsRecord" (date, last_message_id, sheet, updated, views)
VALUES (@p114, @p115, @p116, @p117, @p118)
RETURNING id;
2024-02-25 15:01:41.917 +03:00 [INF] Returning data for ChannelId: 80 with 29 view counts
2024-02-25 15:01:41.927 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[TgCheckerApi.Models.BaseModels.ViewsRecord, TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-02-25 15:01:41.956 +03:00 [INF] Executed action TgCheckerApi.Controllers.BotController.CallGetDailyViewsByChannel (TgCheckerApi) in 15965.8943ms
2024-02-25 15:01:41.960 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.BotController.CallGetDailyViewsByChannel (TgCheckerApi)'
2024-02-25 15:01:41.978 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:7256/api/Bot/getDailyViewsByChannel application/json-patch+json 43 - 200 3524 application/json;+charset=utf-8 16047.3919ms
2024-02-25 15:04:06.330 +03:00 [INF] User profile is available. Using 'C:\Users\timar\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-02-25 15:04:06.499 +03:00 [INF] Default Quartz.NET properties loaded from embedded resource file
2024-02-25 15:04:06.540 +03:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2024-02-25 15:04:06.544 +03:00 [INF] Quartz Scheduler created
2024-02-25 15:04:06.545 +03:00 [INF] RAMJobStore initialized.
2024-02-25 15:04:06.546 +03:00 [INF] Quartz Scheduler 3.8.0.0 - 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2024-02-25 15:04:06.547 +03:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2024-02-25 15:04:06.547 +03:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2024-02-25 15:04:06.548 +03:00 [INF] JobFactory set to: TgCheckerApi.Job.QuartzJobFactory
2024-02-25 15:04:06.591 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-02-25 15:04:06.691 +03:00 [INF] Now listening on: http://localhost:7256
2024-02-25 15:04:06.692 +03:00 [INF] Now listening on: http://localhost:5244
2024-02-25 15:04:06.695 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-02-25 15:04:06.696 +03:00 [INF] Hosting environment: Development
2024-02-25 15:04:06.696 +03:00 [INF] Content root path: C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\
2024-02-25 15:04:06.810 +03:00 [INF] RecalculateTopPosJob started at "2024-02-25T15:04:06.8099498+03:00"
2024-02-25 15:04:06.973 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:7256/BotHub/negotiate?negotiateVersion=0 - 0
2024-02-25 15:04:06.973 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/index.html - -
2024-02-25 15:04:07.003 +03:00 [WRN] Failed to determine the https port for redirect.
2024-02-25 15:04:07.076 +03:00 [INF] Executing endpoint '/BotHub/negotiate'
2024-02-25 15:04:07.105 +03:00 [INF] Executed endpoint '/BotHub/negotiate'
2024-02-25 15:04:07.108 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/BotHub?id=I0hrouaazgR-r_O3nOCqjQ - -
2024-02-25 15:04:07.109 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:7256/BotHub/negotiate?negotiateVersion=0 - 0 - 200 273 application/json 138.4865ms
2024-02-25 15:04:07.110 +03:00 [INF] Executing endpoint '/BotHub'
2024-02-25 15:04:07.243 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/index.html - - - 200 - text/html;charset=utf-8 274.0076ms
2024-02-25 15:04:07.252 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_vs/browserLink - -
2024-02-25 15:04:07.253 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - -
2024-02-25 15:04:07.270 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - - - 200 12356 application/javascript;+charset=utf-8 16.7823ms
2024-02-25 15:04:07.283 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 31.0777ms
2024-02-25 15:04:07.379 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - -
2024-02-25 15:04:07.495 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 115.6644ms
2024-02-25 15:04:08.577 +03:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
ORDER BY c.bumps DESC
2024-02-25 15:04:08.746 +03:00 [INF] RecalculateTopPosJob completed at "2024-02-25T15:04:08.7465874+03:00"
2024-02-25 15:04:16.793 +03:00 [INF] Start processing HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:04:16.797 +03:00 [INF] Sending HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:04:22.094 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:7256/api/Bot/getDailyViewsByChannel application/json-patch+json 43
2024-02-25 15:04:22.096 +03:00 [INF] CORS policy execution successful.
2024-02-25 15:04:22.099 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.BotController.CallGetDailyViewsByChannel (TgCheckerApi)'
2024-02-25 15:04:22.136 +03:00 [INF] Route matched with {action = "CallGetDailyViewsByChannel", controller = "Bot"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CallGetDailyViewsByChannel(DailyViewsRequest) on controller TgCheckerApi.Controllers.BotController (TgCheckerApi).
2024-02-25 15:04:22.218 +03:00 [INF] Starting CallGetDailyViewsByChannel method for ChannelId: 80
2024-02-25 15:04:22.219 +03:00 [INF] Adjusted NumberOfDays to 29 for the current month.
2024-02-25 15:04:22.345 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
WHERE c.id = @__p_0
LIMIT 1
2024-02-25 15:04:22.490 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__dailyViewsRequest_ChannelId_0='?' (DbType = Int32), @__startDate_1='?' (DbType = DateTime), @__endDate_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT v.id, v.date, v.last_message_id, v.sheet, v.updated, v.views
FROM "Channel" AS c
INNER JOIN "StatisticsSheet" AS s ON c.id = s.channel_id
INNER JOIN "ViewsRecord" AS v ON s.id = v.sheet
WHERE c.id = @__dailyViewsRequest_ChannelId_0 AND v.date >= @__startDate_1 AND v.date <= @__endDate_2
ORDER BY v.date
2024-02-25 15:04:22.510 +03:00 [INF] Starting IsUpdateRequiredForChannel method.
2024-02-25 15:04:22.511 +03:00 [INF] Parameters: ChannelId=80, NumberOfDays=29
2024-02-25 15:04:22.512 +03:00 [INF] Outdated threshold set to 360 minutes.
2024-02-25 15:04:22.516 +03:00 [INF] Checking records from 1/27/2024 12:00:00 AM to 2/25/2024 12:00:00 AM.
2024-02-25 15:04:22.523 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__dailyViewsRequest_ChannelId_0='?' (DbType = Int32), @__startDate_1='?' (DbType = DateTime), @__today_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT v.id, v.date, v.last_message_id, v.sheet, v.updated, v.views
FROM "Channel" AS c
INNER JOIN "StatisticsSheet" AS s ON c.id = s.channel_id
INNER JOIN "ViewsRecord" AS v ON s.id = v.sheet
WHERE c.id = @__dailyViewsRequest_ChannelId_0 AND v.date >= @__startDate_1 AND v.date <= @__today_2
2024-02-25 15:04:22.526 +03:00 [INF] 30 records found in date range.
2024-02-25 15:04:22.526 +03:00 [INF] Update required: True
2024-02-25 15:04:22.527 +03:00 [INF] Data is complete but outdated for ChannelId: 80. Initiating background update.
2024-02-25 15:04:22.540 +03:00 [INF] Received request for getDailyViewsByChannel. Request hash: 994993270c9bedd8e324fd05c3ee27d501685d3662231ca53c6a0e18ceee0b6b
2024-02-25 15:04:22.567 +03:00 [INF] Returning data for ChannelId: 80 with 29 view counts
2024-02-25 15:04:22.578 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[TgCheckerApi.Models.BaseModels.ViewsRecord, TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.ValueTuple`2[[System.Int32, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-02-25 15:04:22.610 +03:00 [INF] Executed action TgCheckerApi.Controllers.BotController.CallGetDailyViewsByChannel (TgCheckerApi) in 464.8976ms
2024-02-25 15:04:22.614 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.BotController.CallGetDailyViewsByChannel (TgCheckerApi)'
2024-02-25 15:04:22.632 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:7256/api/Bot/getDailyViewsByChannel application/json-patch+json 43 - 200 1306 application/json;+charset=utf-8 538.6249ms
2024-02-25 15:08:01.428 +03:00 [INF] User profile is available. Using 'C:\Users\timar\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-02-25 15:08:01.601 +03:00 [INF] Default Quartz.NET properties loaded from embedded resource file
2024-02-25 15:08:01.638 +03:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2024-02-25 15:08:01.639 +03:00 [INF] Quartz Scheduler created
2024-02-25 15:08:01.643 +03:00 [INF] RAMJobStore initialized.
2024-02-25 15:08:01.644 +03:00 [INF] Quartz Scheduler 3.8.0.0 - 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2024-02-25 15:08:01.644 +03:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2024-02-25 15:08:01.645 +03:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2024-02-25 15:08:01.646 +03:00 [INF] JobFactory set to: TgCheckerApi.Job.QuartzJobFactory
2024-02-25 15:08:01.688 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-02-25 15:08:01.781 +03:00 [INF] Now listening on: http://localhost:7256
2024-02-25 15:08:01.814 +03:00 [INF] Now listening on: http://localhost:5244
2024-02-25 15:08:01.817 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-02-25 15:08:01.818 +03:00 [INF] Hosting environment: Development
2024-02-25 15:08:01.819 +03:00 [INF] Content root path: C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\
2024-02-25 15:08:01.898 +03:00 [INF] RecalculateTopPosJob started at "2024-02-25T15:08:01.8975228+03:00"
2024-02-25 15:08:02.404 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger - -
2024-02-25 15:08:02.460 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger - - - 301 0 - 58.8731ms
2024-02-25 15:08:02.601 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/index.html - -
2024-02-25 15:08:02.832 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/index.html - - - 200 - text/html;charset=utf-8 230.6339ms
2024-02-25 15:08:02.890 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/swagger-ui.css - -
2024-02-25 15:08:02.912 +03:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2024-02-25 15:08:02.913 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/swagger-ui.css - - - 200 144929 text/css 23.3045ms
2024-02-25 15:08:02.994 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_vs/browserLink - -
2024-02-25 15:08:02.994 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/swagger-ui-standalone-preset.js - -
2024-02-25 15:08:02.994 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/swagger-ui-bundle.js - -
2024-02-25 15:08:03.005 +03:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2024-02-25 15:08:03.007 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/swagger-ui-standalone-preset.js - - - 200 312163 application/javascript 12.8934ms
2024-02-25 15:08:03.018 +03:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2024-02-25 15:08:03.019 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/swagger-ui-bundle.js - - - 200 1061536 application/javascript 25.2097ms
2024-02-25 15:08:03.027 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 32.6116ms
2024-02-25 15:08:03.063 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - -
2024-02-25 15:08:03.069 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - - - 200 12356 application/javascript;+charset=utf-8 5.9075ms
2024-02-25 15:08:03.211 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - -
2024-02-25 15:08:03.226 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/favicon-32x32.png - -
2024-02-25 15:08:03.227 +03:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2024-02-25 15:08:03.230 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/favicon-32x32.png - - - 200 628 image/png 3.1853ms
2024-02-25 15:08:03.340 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 128.8129ms
2024-02-25 15:08:03.682 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
ORDER BY c.bumps DESC
2024-02-25 15:08:03.847 +03:00 [INF] RecalculateTopPosJob completed at "2024-02-25T15:08:03.8470422+03:00"
2024-02-25 15:08:06.567 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:7256/BotHub/negotiate?negotiateVersion=0 - 0
2024-02-25 15:08:06.571 +03:00 [WRN] Failed to determine the https port for redirect.
2024-02-25 15:08:06.639 +03:00 [INF] Executing endpoint '/BotHub/negotiate'
2024-02-25 15:08:06.653 +03:00 [INF] Executed endpoint '/BotHub/negotiate'
2024-02-25 15:08:06.654 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:7256/BotHub/negotiate?negotiateVersion=0 - 0 - 200 273 application/json 87.1847ms
2024-02-25 15:08:06.656 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/BotHub?id=eqKFeqeEWknfxy2yKOFypw - -
2024-02-25 15:08:06.657 +03:00 [INF] Executing endpoint '/BotHub'
2024-02-25 15:08:11.874 +03:00 [INF] Start processing HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:08:11.877 +03:00 [INF] Sending HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:08:12.355 +03:00 [INF] Received HTTP response headers after 472.3426ms - 200
2024-02-25 15:08:12.358 +03:00 [INF] End processing HTTP request after 486.7459ms - 200
2024-02-25 15:08:12.363 +03:00 [INF] Successfully processed all channels via HTTP request at: {DateTime.UtcNow}
2024-02-25 15:08:13.099 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:7256/api/Bot/getDailyViewsByChannel application/json-patch+json 43
2024-02-25 15:08:13.102 +03:00 [INF] CORS policy execution successful.
2024-02-25 15:08:13.106 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.BotController.CallGetDailyViewsByChannel (TgCheckerApi)'
2024-02-25 15:08:13.140 +03:00 [INF] Route matched with {action = "CallGetDailyViewsByChannel", controller = "Bot"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CallGetDailyViewsByChannel(DailyViewsRequest) on controller TgCheckerApi.Controllers.BotController (TgCheckerApi).
2024-02-25 15:08:13.231 +03:00 [INF] Starting CallGetDailyViewsByChannel method for ChannelId: 80
2024-02-25 15:08:13.232 +03:00 [INF] Adjusted NumberOfDays to 29 for the current month.
2024-02-25 15:08:13.368 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
WHERE c.id = @__p_0
LIMIT 1
2024-02-25 15:08:13.523 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__dailyViewsRequest_ChannelId_0='?' (DbType = Int32), @__startDate_1='?' (DbType = DateTime), @__endDate_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT v.id, v.date, v.last_message_id, v.sheet, v.updated, v.views
FROM "Channel" AS c
INNER JOIN "StatisticsSheet" AS s ON c.id = s.channel_id
INNER JOIN "ViewsRecord" AS v ON s.id = v.sheet
WHERE c.id = @__dailyViewsRequest_ChannelId_0 AND v.date >= @__startDate_1 AND v.date <= @__endDate_2
ORDER BY v.date
2024-02-25 15:08:13.545 +03:00 [INF] Starting IsUpdateRequiredForChannel method.
2024-02-25 15:08:13.548 +03:00 [INF] Parameters: ChannelId=80, NumberOfDays=29
2024-02-25 15:08:13.552 +03:00 [INF] Outdated threshold set to 360 minutes.
2024-02-25 15:08:13.558 +03:00 [INF] Checking records from 1/27/2024 12:00:00 AM to 2/25/2024 12:00:00 AM.
2024-02-25 15:08:13.565 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__dailyViewsRequest_ChannelId_0='?' (DbType = Int32), @__startDate_1='?' (DbType = DateTime), @__today_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT v.id, v.date, v.last_message_id, v.sheet, v.updated, v.views
FROM "Channel" AS c
INNER JOIN "StatisticsSheet" AS s ON c.id = s.channel_id
INNER JOIN "ViewsRecord" AS v ON s.id = v.sheet
WHERE c.id = @__dailyViewsRequest_ChannelId_0 AND v.date >= @__startDate_1 AND v.date <= @__today_2
2024-02-25 15:08:13.568 +03:00 [INF] 30 records found in date range.
2024-02-25 15:08:13.568 +03:00 [INF] Update required: True
2024-02-25 15:08:13.569 +03:00 [INF] Data is complete but outdated for ChannelId: 80. Initiating background update.
2024-02-25 15:08:13.584 +03:00 [INF] Received request for getDailyViewsByChannel. Request hash: 994993270c9bedd8e324fd05c3ee27d501685d3662231ca53c6a0e18ceee0b6b
2024-02-25 15:08:13.613 +03:00 [INF] Returning data for ChannelId: 80 with 29 view counts
2024-02-25 15:08:13.625 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[TgCheckerApi.Models.BaseModels.ViewsRecord, TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.ValueTuple`2[[System.Int32, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-02-25 15:08:13.659 +03:00 [INF] Executed action TgCheckerApi.Controllers.BotController.CallGetDailyViewsByChannel (TgCheckerApi) in 511.3186ms
2024-02-25 15:08:13.662 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.BotController.CallGetDailyViewsByChannel (TgCheckerApi)'
2024-02-25 15:08:13.680 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:7256/api/Bot/getDailyViewsByChannel application/json-patch+json 43 - 200 1306 application/json;+charset=utf-8 580.5339ms
2024-02-25 15:08:43.620 +03:00 [WRN] New task timed out. Hash: 994993270c9bedd8e324fd05c3ee27d501685d3662231ca53c6a0e18ceee0b6b
2024-02-25 15:08:43.621 +03:00 [WRN] Invalid or no response from WebSocket service for ChannelId: 80
2024-02-25 15:09:52.214 +03:00 [INF] User profile is available. Using 'C:\Users\timar\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-02-25 15:09:52.357 +03:00 [INF] Default Quartz.NET properties loaded from embedded resource file
2024-02-25 15:09:52.394 +03:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2024-02-25 15:09:52.394 +03:00 [INF] Quartz Scheduler created
2024-02-25 15:09:52.400 +03:00 [INF] RAMJobStore initialized.
2024-02-25 15:09:52.402 +03:00 [INF] Quartz Scheduler 3.8.0.0 - 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2024-02-25 15:09:52.404 +03:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2024-02-25 15:09:52.405 +03:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2024-02-25 15:09:52.407 +03:00 [INF] JobFactory set to: TgCheckerApi.Job.QuartzJobFactory
2024-02-25 15:09:52.452 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-02-25 15:09:52.542 +03:00 [INF] Now listening on: http://localhost:7256
2024-02-25 15:09:52.542 +03:00 [INF] Now listening on: http://localhost:5244
2024-02-25 15:09:52.546 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-02-25 15:09:52.546 +03:00 [INF] Hosting environment: Development
2024-02-25 15:09:52.547 +03:00 [INF] Content root path: C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\
2024-02-25 15:09:52.625 +03:00 [INF] RecalculateTopPosJob started at "2024-02-25T15:09:52.6251725+03:00"
2024-02-25 15:09:52.959 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/index.html - -
2024-02-25 15:09:53.236 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/index.html - - - 200 - text/html;charset=utf-8 279.9727ms
2024-02-25 15:09:53.238 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_vs/browserLink - -
2024-02-25 15:09:53.246 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - -
2024-02-25 15:09:53.255 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - - - 200 12356 application/javascript;+charset=utf-8 9.3867ms
2024-02-25 15:09:53.264 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 26.4464ms
2024-02-25 15:09:53.393 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - -
2024-02-25 15:09:53.530 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 136.9646ms
2024-02-25 15:09:54.394 +03:00 [INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
ORDER BY c.bumps DESC
2024-02-25 15:09:54.583 +03:00 [INF] RecalculateTopPosJob completed at "2024-02-25T15:09:54.5835338+03:00"
2024-02-25 15:09:54.901 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:7256/BotHub/negotiate?negotiateVersion=0 - 0
2024-02-25 15:09:54.906 +03:00 [WRN] Failed to determine the https port for redirect.
2024-02-25 15:09:54.986 +03:00 [INF] Executing endpoint '/BotHub/negotiate'
2024-02-25 15:09:55.001 +03:00 [INF] Executed endpoint '/BotHub/negotiate'
2024-02-25 15:09:55.002 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:7256/BotHub/negotiate?negotiateVersion=0 - 0 - 200 273 application/json 100.9002ms
2024-02-25 15:09:55.004 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/BotHub?id=Z9WeR_1QEbMPIxsHLE9XnA - -
2024-02-25 15:09:55.006 +03:00 [INF] Executing endpoint '/BotHub'
2024-02-25 15:10:02.663 +03:00 [INF] Start processing HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:10:02.673 +03:00 [INF] Sending HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:10:06.598 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:7256/api/Bot/getDailyViewsByChannel application/json-patch+json 43
2024-02-25 15:10:06.600 +03:00 [INF] CORS policy execution successful.
2024-02-25 15:10:06.604 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.BotController.CallGetDailyViewsByChannel (TgCheckerApi)'
2024-02-25 15:10:06.637 +03:00 [INF] Route matched with {action = "CallGetDailyViewsByChannel", controller = "Bot"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CallGetDailyViewsByChannel(DailyViewsRequest) on controller TgCheckerApi.Controllers.BotController (TgCheckerApi).
2024-02-25 15:10:06.729 +03:00 [INF] Starting CallGetDailyViewsByChannel method for ChannelId: 80
2024-02-25 15:10:06.730 +03:00 [INF] Adjusted NumberOfDays to 29 for the current month.
2024-02-25 15:10:06.857 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
WHERE c.id = @__p_0
LIMIT 1
2024-02-25 15:10:07.002 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__dailyViewsRequest_ChannelId_0='?' (DbType = Int32), @__startDate_1='?' (DbType = DateTime), @__endDate_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT v.id, v.date, v.last_message_id, v.sheet, v.updated, v.views
FROM "Channel" AS c
INNER JOIN "StatisticsSheet" AS s ON c.id = s.channel_id
INNER JOIN "ViewsRecord" AS v ON s.id = v.sheet
WHERE c.id = @__dailyViewsRequest_ChannelId_0 AND v.date >= @__startDate_1 AND v.date <= @__endDate_2
ORDER BY v.date
2024-02-25 15:10:07.023 +03:00 [INF] Starting IsUpdateRequiredForChannel method.
2024-02-25 15:10:07.024 +03:00 [INF] Parameters: ChannelId=80, NumberOfDays=29
2024-02-25 15:10:07.025 +03:00 [INF] Outdated threshold set to 360 minutes.
2024-02-25 15:10:07.030 +03:00 [INF] Checking records from 1/27/2024 12:00:00 AM to 2/25/2024 12:00:00 AM.
2024-02-25 15:10:07.040 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__dailyViewsRequest_ChannelId_0='?' (DbType = Int32), @__startDate_1='?' (DbType = DateTime), @__today_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT v.id, v.date, v.last_message_id, v.sheet, v.updated, v.views
FROM "Channel" AS c
INNER JOIN "StatisticsSheet" AS s ON c.id = s.channel_id
INNER JOIN "ViewsRecord" AS v ON s.id = v.sheet
WHERE c.id = @__dailyViewsRequest_ChannelId_0 AND v.date >= @__startDate_1 AND v.date <= @__today_2
2024-02-25 15:10:07.043 +03:00 [INF] 30 records found in date range.
2024-02-25 15:10:07.043 +03:00 [INF] Update required: True
2024-02-25 15:10:07.044 +03:00 [INF] Data is complete but outdated for ChannelId: 80. Initiating background update.
2024-02-25 15:10:07.058 +03:00 [INF] Received request for getDailyViewsByChannel. Request hash: 994993270c9bedd8e324fd05c3ee27d501685d3662231ca53c6a0e18ceee0b6b
2024-02-25 15:10:07.085 +03:00 [INF] Returning data for ChannelId: 80 with 29 view counts
2024-02-25 15:10:07.096 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[TgCheckerApi.Models.BaseModels.ViewsRecord, TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.ValueTuple`2[[System.Int32, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-02-25 15:10:07.129 +03:00 [INF] Executed action TgCheckerApi.Controllers.BotController.CallGetDailyViewsByChannel (TgCheckerApi) in 482.8449ms
2024-02-25 15:10:07.132 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.BotController.CallGetDailyViewsByChannel (TgCheckerApi)'
2024-02-25 15:10:07.149 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:7256/api/Bot/getDailyViewsByChannel application/json-patch+json 43 - 200 1306 application/json;+charset=utf-8 551.0388ms
2024-02-25 15:10:37.096 +03:00 [WRN] New task timed out. Hash: 994993270c9bedd8e324fd05c3ee27d501685d3662231ca53c6a0e18ceee0b6b
2024-02-25 15:10:37.097 +03:00 [WRN] Invalid or no response from WebSocket service for ChannelId: 80
2024-02-25 15:13:27.723 +03:00 [INF] User profile is available. Using 'C:\Users\timar\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-02-25 15:13:27.870 +03:00 [INF] Default Quartz.NET properties loaded from embedded resource file
2024-02-25 15:13:27.912 +03:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2024-02-25 15:13:27.916 +03:00 [INF] Quartz Scheduler created
2024-02-25 15:13:27.917 +03:00 [INF] RAMJobStore initialized.
2024-02-25 15:13:27.918 +03:00 [INF] Quartz Scheduler 3.8.0.0 - 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2024-02-25 15:13:27.918 +03:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2024-02-25 15:13:27.919 +03:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2024-02-25 15:13:27.920 +03:00 [INF] JobFactory set to: TgCheckerApi.Job.QuartzJobFactory
2024-02-25 15:13:27.963 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-02-25 15:13:28.054 +03:00 [INF] Now listening on: http://localhost:7256
2024-02-25 15:13:28.055 +03:00 [INF] Now listening on: http://localhost:5244
2024-02-25 15:13:28.062 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-02-25 15:13:28.063 +03:00 [INF] Hosting environment: Development
2024-02-25 15:13:28.064 +03:00 [INF] Content root path: C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\
2024-02-25 15:13:28.145 +03:00 [INF] RecalculateTopPosJob started at "2024-02-25T15:13:28.1447662+03:00"
2024-02-25 15:13:28.680 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/index.html - -
2024-02-25 15:13:28.947 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/index.html - - - 200 - text/html;charset=utf-8 270.5773ms
2024-02-25 15:13:28.949 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_vs/browserLink - -
2024-02-25 15:13:28.956 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - -
2024-02-25 15:13:28.962 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - - - 200 12356 application/javascript;+charset=utf-8 6.0741ms
2024-02-25 15:13:28.971 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 22.0416ms
2024-02-25 15:13:29.041 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - -
2024-02-25 15:13:29.180 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 139.3914ms
2024-02-25 15:13:29.914 +03:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
ORDER BY c.bumps DESC
2024-02-25 15:13:30.097 +03:00 [INF] RecalculateTopPosJob completed at "2024-02-25T15:13:30.0976977+03:00"
2024-02-25 15:13:30.224 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:7256/BotHub/negotiate?negotiateVersion=0 - 0
2024-02-25 15:13:30.229 +03:00 [WRN] Failed to determine the https port for redirect.
2024-02-25 15:13:30.300 +03:00 [INF] Executing endpoint '/BotHub/negotiate'
2024-02-25 15:13:30.313 +03:00 [INF] Executed endpoint '/BotHub/negotiate'
2024-02-25 15:13:30.314 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:7256/BotHub/negotiate?negotiateVersion=0 - 0 - 200 273 application/json 90.2447ms
2024-02-25 15:13:30.315 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/BotHub?id=XJpA0hGZLCuhCCquzUaPFg - -
2024-02-25 15:13:30.317 +03:00 [INF] Executing endpoint '/BotHub'
2024-02-25 15:13:37.667 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:7256/api/Bot/getDailyViewsByChannel application/json-patch+json 43
2024-02-25 15:13:37.669 +03:00 [INF] CORS policy execution successful.
2024-02-25 15:13:37.673 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.BotController.CallGetDailyViewsByChannel (TgCheckerApi)'
2024-02-25 15:13:37.704 +03:00 [INF] Route matched with {action = "CallGetDailyViewsByChannel", controller = "Bot"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CallGetDailyViewsByChannel(DailyViewsRequest) on controller TgCheckerApi.Controllers.BotController (TgCheckerApi).
2024-02-25 15:13:37.877 +03:00 [INF] Starting CallGetDailyViewsByChannel method for ChannelId: 80
2024-02-25 15:13:37.878 +03:00 [INF] Adjusted NumberOfDays to 29 for the current month.
2024-02-25 15:13:38.007 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
WHERE c.id = @__p_0
LIMIT 1
2024-02-25 15:13:38.083 +03:00 [INF] Start processing HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:13:38.087 +03:00 [INF] Sending HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:13:38.159 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__dailyViewsRequest_ChannelId_0='?' (DbType = Int32), @__startDate_1='?' (DbType = DateTime), @__endDate_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT v.id, v.date, v.last_message_id, v.sheet, v.updated, v.views
FROM "Channel" AS c
INNER JOIN "StatisticsSheet" AS s ON c.id = s.channel_id
INNER JOIN "ViewsRecord" AS v ON s.id = v.sheet
WHERE c.id = @__dailyViewsRequest_ChannelId_0 AND v.date >= @__startDate_1 AND v.date <= @__endDate_2
ORDER BY v.date
2024-02-25 15:13:38.179 +03:00 [INF] Starting IsUpdateRequiredForChannel method.
2024-02-25 15:13:38.180 +03:00 [INF] Parameters: ChannelId=80, NumberOfDays=29
2024-02-25 15:13:38.181 +03:00 [INF] Outdated threshold set to 360 minutes.
2024-02-25 15:13:38.186 +03:00 [INF] Checking records from 1/27/2024 12:00:00 AM to 2/25/2024 12:00:00 AM.
2024-02-25 15:13:38.192 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__dailyViewsRequest_ChannelId_0='?' (DbType = Int32), @__startDate_1='?' (DbType = DateTime), @__today_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT v.id, v.date, v.last_message_id, v.sheet, v.updated, v.views
FROM "Channel" AS c
INNER JOIN "StatisticsSheet" AS s ON c.id = s.channel_id
INNER JOIN "ViewsRecord" AS v ON s.id = v.sheet
WHERE c.id = @__dailyViewsRequest_ChannelId_0 AND v.date >= @__startDate_1 AND v.date <= @__today_2
2024-02-25 15:13:38.195 +03:00 [INF] 30 records found in date range.
2024-02-25 15:13:38.196 +03:00 [INF] Update required: True
2024-02-25 15:13:38.197 +03:00 [INF] Data is complete but outdated for ChannelId: 80. Initiating background update.
2024-02-25 15:13:38.213 +03:00 [INF] Received request for getDailyViewsByChannel. Request hash: 994993270c9bedd8e324fd05c3ee27d501685d3662231ca53c6a0e18ceee0b6b
2024-02-25 15:13:38.245 +03:00 [INF] Returning data for ChannelId: 80 with 29 view counts
2024-02-25 15:13:38.255 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[TgCheckerApi.Models.BaseModels.ViewsRecord, TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[<>f__AnonymousType7`2[[System.Int32, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-02-25 15:13:38.281 +03:00 [INF] Executed action TgCheckerApi.Controllers.BotController.CallGetDailyViewsByChannel (TgCheckerApi) in 569.0624ms
2024-02-25 15:13:38.284 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.BotController.CallGetDailyViewsByChannel (TgCheckerApi)'
2024-02-25 15:13:38.301 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:7256/api/Bot/getDailyViewsByChannel application/json-patch+json 43 - 200 1277 application/json;+charset=utf-8 634.3848ms
2024-02-25 15:18:16.742 +03:00 [INF] User profile is available. Using 'C:\Users\timar\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-02-25 15:18:16.889 +03:00 [INF] Default Quartz.NET properties loaded from embedded resource file
2024-02-25 15:18:16.930 +03:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2024-02-25 15:18:16.935 +03:00 [INF] Quartz Scheduler created
2024-02-25 15:18:16.936 +03:00 [INF] RAMJobStore initialized.
2024-02-25 15:18:16.936 +03:00 [INF] Quartz Scheduler 3.8.0.0 - 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2024-02-25 15:18:16.937 +03:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2024-02-25 15:18:16.938 +03:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2024-02-25 15:18:16.940 +03:00 [INF] JobFactory set to: TgCheckerApi.Job.QuartzJobFactory
2024-02-25 15:18:16.985 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-02-25 15:18:17.088 +03:00 [INF] Now listening on: http://localhost:7256
2024-02-25 15:18:17.093 +03:00 [INF] Now listening on: http://localhost:5244
2024-02-25 15:18:17.097 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-02-25 15:18:17.098 +03:00 [INF] Hosting environment: Development
2024-02-25 15:18:17.098 +03:00 [INF] Content root path: C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\
2024-02-25 15:18:17.175 +03:00 [INF] RecalculateTopPosJob started at "2024-02-25T15:18:17.1747057+03:00"
2024-02-25 15:18:17.455 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:7256/BotHub/negotiate?negotiateVersion=0 - 0
2024-02-25 15:18:17.467 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/index.html - -
2024-02-25 15:18:17.485 +03:00 [WRN] Failed to determine the https port for redirect.
2024-02-25 15:18:17.553 +03:00 [INF] Executing endpoint '/BotHub/negotiate'
2024-02-25 15:18:17.579 +03:00 [INF] Executed endpoint '/BotHub/negotiate'
2024-02-25 15:18:17.584 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/BotHub?id=V-dnAihm-EMbxq8-d4nvLg - -
2024-02-25 15:18:17.584 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:7256/BotHub/negotiate?negotiateVersion=0 - 0 - 200 273 application/json 129.5009ms
2024-02-25 15:18:17.586 +03:00 [INF] Executing endpoint '/BotHub'
2024-02-25 15:18:17.726 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/index.html - - - 200 - text/html;charset=utf-8 258.7475ms
2024-02-25 15:18:17.730 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_vs/browserLink - -
2024-02-25 15:18:17.731 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - -
2024-02-25 15:18:17.734 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - - - 200 12356 application/javascript;+charset=utf-8 3.3805ms
2024-02-25 15:18:17.746 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 15.9170ms
2024-02-25 15:18:17.814 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - -
2024-02-25 15:18:17.929 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 115.5149ms
2024-02-25 15:18:18.875 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
ORDER BY c.bumps DESC
2024-02-25 15:18:19.055 +03:00 [INF] RecalculateTopPosJob completed at "2024-02-25T15:18:19.0559499+03:00"
2024-02-25 15:18:23.997 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/api/Channel - -
2024-02-25 15:18:24.001 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.ChannelController.GetChannels (TgCheckerApi)'
2024-02-25 15:18:24.021 +03:00 [INF] Route matched with {action = "GetChannels", controller = "Channel"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[TgCheckerApi.Models.GetModels.ChannelGetModel]]] GetChannels() on controller TgCheckerApi.Controllers.ChannelController (TgCheckerApi).
2024-02-25 15:18:24.188 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
ORDER BY c.bumps DESC
2024-02-25 15:18:24.523 +03:00 [INF] Executed DbCommand (61ms) [Parameters=[@__channel_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel, c.tag, t.id, t.text
FROM "ChannelHasTag" AS c
LEFT JOIN "Tag" AS t ON c.tag = t.id
WHERE c.channel = @__channel_Id_0
2024-02-25 15:18:24.611 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:18:24.626 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__channel_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel, c.tag, t.id, t.text
FROM "ChannelHasTag" AS c
LEFT JOIN "Tag" AS t ON c.tag = t.id
WHERE c.channel = @__channel_Id_0
2024-02-25 15:18:24.630 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:18:24.632 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__channel_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel, c.tag, t.id, t.text
FROM "ChannelHasTag" AS c
LEFT JOIN "Tag" AS t ON c.tag = t.id
WHERE c.channel = @__channel_Id_0
2024-02-25 15:18:24.634 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:18:24.636 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__channel_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel, c.tag, t.id, t.text
FROM "ChannelHasTag" AS c
LEFT JOIN "Tag" AS t ON c.tag = t.id
WHERE c.channel = @__channel_Id_0
2024-02-25 15:18:24.638 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:18:24.641 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__channel_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel, c.tag, t.id, t.text
FROM "ChannelHasTag" AS c
LEFT JOIN "Tag" AS t ON c.tag = t.id
WHERE c.channel = @__channel_Id_0
2024-02-25 15:18:24.643 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:18:24.645 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__channel_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel, c.tag, t.id, t.text
FROM "ChannelHasTag" AS c
LEFT JOIN "Tag" AS t ON c.tag = t.id
WHERE c.channel = @__channel_Id_0
2024-02-25 15:18:24.648 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:18:24.651 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__channel_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel, c.tag, t.id, t.text
FROM "ChannelHasTag" AS c
LEFT JOIN "Tag" AS t ON c.tag = t.id
WHERE c.channel = @__channel_Id_0
2024-02-25 15:18:24.653 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:18:24.655 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__channel_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel, c.tag, t.id, t.text
FROM "ChannelHasTag" AS c
LEFT JOIN "Tag" AS t ON c.tag = t.id
WHERE c.channel = @__channel_Id_0
2024-02-25 15:18:24.658 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:18:24.660 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__channel_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel, c.tag, t.id, t.text
FROM "ChannelHasTag" AS c
LEFT JOIN "Tag" AS t ON c.tag = t.id
WHERE c.channel = @__channel_Id_0
2024-02-25 15:18:24.662 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:18:24.664 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__channel_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel, c.tag, t.id, t.text
FROM "ChannelHasTag" AS c
LEFT JOIN "Tag" AS t ON c.tag = t.id
WHERE c.channel = @__channel_Id_0
2024-02-25 15:18:24.666 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:18:24.668 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__channel_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel, c.tag, t.id, t.text
FROM "ChannelHasTag" AS c
LEFT JOIN "Tag" AS t ON c.tag = t.id
WHERE c.channel = @__channel_Id_0
2024-02-25 15:18:24.670 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:18:24.687 +03:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[TgCheckerApi.Models.GetModels.ChannelGetModel, TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-02-25 15:18:24.855 +03:00 [INF] Executed action TgCheckerApi.Controllers.ChannelController.GetChannels (TgCheckerApi) in 825.3689ms
2024-02-25 15:18:24.859 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.ChannelController.GetChannels (TgCheckerApi)'
2024-02-25 15:18:24.875 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/api/Channel - - - 200 40881 application/json;+charset=utf-8 878.0040ms
2024-02-25 15:18:27.071 +03:00 [INF] Start processing HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:18:27.075 +03:00 [INF] Sending HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:18:27.481 +03:00 [INF] Received HTTP response headers after 399.812ms - 200
2024-02-25 15:18:27.483 +03:00 [INF] End processing HTTP request after 413.6518ms - 200
2024-02-25 15:18:27.487 +03:00 [INF] Successfully processed all channels via HTTP request at: {DateTime.UtcNow}
2024-02-25 15:18:56.412 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:7256/api/User application/json 165
2024-02-25 15:18:56.414 +03:00 [INF] Executing endpoint 'TgCheckerApi.MapperProfiles.UserController.PostUser (TgCheckerApi)'
2024-02-25 15:18:56.432 +03:00 [INF] Route matched with {action = "PostUser", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[TgCheckerApi.Models.BaseModels.User]] PostUser(TgCheckerApi.Models.UserPostModel) on controller TgCheckerApi.MapperProfiles.UserController (TgCheckerApi).
2024-02-25 15:18:56.705 +03:00 [INF] Executed DbCommand (49ms) [Parameters=[@__user_TelegramId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.avatar, u.chat_id, u.last_update, u.notification_settings, u.telegram_id, u.unique_key, u.username
FROM "User" AS u
WHERE u.telegram_id = @__user_TelegramId_0
LIMIT 1
2024-02-25 15:18:56.735 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'System.String'.
2024-02-25 15:18:56.736 +03:00 [INF] Executed action TgCheckerApi.MapperProfiles.UserController.PostUser (TgCheckerApi) in 301.1515ms
2024-02-25 15:18:56.737 +03:00 [INF] Executed endpoint 'TgCheckerApi.MapperProfiles.UserController.PostUser (TgCheckerApi)'
2024-02-25 15:18:56.739 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:7256/api/User application/json 165 - 400 - text/plain;+charset=utf-8 327.2910ms
2024-02-25 15:18:56.740 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:7256/api/Auth?connectionId=-HAfMQ_SJQd4QWqqZ7nGtQ application/json 69
2024-02-25 15:18:56.741 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.AuthController.SendMessage (TgCheckerApi)'
2024-02-25 15:18:56.746 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessage(System.String, TgCheckerApi.Models.SendMessagePayload) on controller TgCheckerApi.Controllers.AuthController (TgCheckerApi).
2024-02-25 15:18:56.763 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__payload_UserId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.avatar, u.chat_id, u.last_update, u.notification_settings, u.telegram_id, u.unique_key, u.username
FROM "User" AS u
WHERE u.telegram_id = @__payload_UserId_0
LIMIT 1
2024-02-25 15:18:56.821 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2024-02-25 15:18:56.823 +03:00 [INF] Executed action TgCheckerApi.Controllers.AuthController.SendMessage (TgCheckerApi) in 75.339ms
2024-02-25 15:18:56.824 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.AuthController.SendMessage (TgCheckerApi)'
2024-02-25 15:18:56.825 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:7256/api/Auth?connectionId=-HAfMQ_SJQd4QWqqZ7nGtQ application/json 69 - 200 - text/plain;+charset=utf-8 85.1195ms
2024-02-25 15:19:04.094 +03:00 [ERR] Failed to invoke hub method 'ReceiveStream'.
System.OperationCanceledException: The underlying connection was closed.
   at System.Threading.Channels.AsyncOperation`1.GetResult(Int16 token)
   at System.Threading.Channels.ChannelReader`1.ReadAllAsync(CancellationToken cancellationToken)+MoveNext()
   at System.Threading.Channels.ChannelReader`1.ReadAllAsync(CancellationToken cancellationToken)+System.Threading.Tasks.Sources.IValueTaskSource<System.Boolean>.GetResult()
   at TgCheckerApi.Websockets.BotHub.ReceiveStream(IAsyncEnumerable`1 stream, String param) in C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\Websockets\BotHub.cs:line 39
   at TgCheckerApi.Websockets.BotHub.ReceiveStream(IAsyncEnumerable`1 stream, String param) in C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\Websockets\BotHub.cs:line 39
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.ExecuteMethod(ObjectMethodExecutor methodExecutor, Hub hub, Object[] arguments)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.<Invoke>g__ExecuteInvocation|16_0(DefaultHubDispatcher`1 dispatcher, ObjectMethodExecutor methodExecutor, THub hub, Object[] arguments, AsyncServiceScope scope, IHubActivator`1 hubActivator, HubConnectionContext connection, HubMethodInvocationMessage hubMethodInvocationMessage, Boolean isStreamCall)
2024-02-25 15:19:04.096 +03:00 [INF] Executed endpoint '/BotHub'
2024-02-25 15:19:04.185 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/BotHub?id=V-dnAihm-EMbxq8-d4nvLg - - - 101 - - 46600.5329ms
2024-02-25 15:20:23.728 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:7256/api/Auth?connectionId=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoidXNlcjQzMjQzMjEiLCJ1c2VySWQiOiIxMzQyMTQ3ODE2Iiwia2V5IjoiYmVicmEiLCJleHAiOjE3MDk0NjgzNDl9.P_vtLoemd8CWgcd22V8DA3J7es5YvdcNEVt9-AVIq7o application/json-patch+json 67
2024-02-25 15:20:23.736 +03:00 [INF] CORS policy execution successful.
2024-02-25 15:20:23.737 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.AuthController.SendMessage (TgCheckerApi)'
2024-02-25 15:20:23.739 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessage(System.String, TgCheckerApi.Models.SendMessagePayload) on controller TgCheckerApi.Controllers.AuthController (TgCheckerApi).
2024-02-25 15:20:23.749 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__payload_UserId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.avatar, u.chat_id, u.last_update, u.notification_settings, u.telegram_id, u.unique_key, u.username
FROM "User" AS u
WHERE u.telegram_id = @__payload_UserId_0
LIMIT 1
2024-02-25 15:33:14.829 +03:00 [INF] User profile is available. Using 'C:\Users\timar\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-02-25 15:33:14.988 +03:00 [INF] Default Quartz.NET properties loaded from embedded resource file
2024-02-25 15:33:15.023 +03:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2024-02-25 15:33:15.027 +03:00 [INF] Quartz Scheduler created
2024-02-25 15:33:15.028 +03:00 [INF] RAMJobStore initialized.
2024-02-25 15:33:15.029 +03:00 [INF] Quartz Scheduler 3.8.0.0 - 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2024-02-25 15:33:15.030 +03:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2024-02-25 15:33:15.031 +03:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2024-02-25 15:33:15.032 +03:00 [INF] JobFactory set to: TgCheckerApi.Job.QuartzJobFactory
2024-02-25 15:33:15.087 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-02-25 15:33:15.179 +03:00 [INF] Now listening on: http://localhost:7256
2024-02-25 15:33:15.180 +03:00 [INF] Now listening on: http://localhost:5244
2024-02-25 15:33:15.188 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-02-25 15:33:15.189 +03:00 [INF] Hosting environment: Development
2024-02-25 15:33:15.194 +03:00 [INF] Content root path: C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\
2024-02-25 15:33:15.289 +03:00 [INF] RecalculateTopPosJob started at "2024-02-25T15:33:15.2885361+03:00"
2024-02-25 15:33:16.274 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/index.html - -
2024-02-25 15:33:16.581 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - -
2024-02-25 15:33:16.581 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_vs/browserLink - -
2024-02-25 15:33:16.588 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - - - 200 12356 application/javascript;+charset=utf-8 3.4939ms
2024-02-25 15:33:16.588 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/index.html - - - 200 - text/html;charset=utf-8 318.6939ms
2024-02-25 15:33:16.598 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 16.9382ms
2024-02-25 15:33:16.667 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - -
2024-02-25 15:33:16.802 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 135.1465ms
2024-02-25 15:33:17.403 +03:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
ORDER BY c.bumps DESC
2024-02-25 15:33:17.586 +03:00 [INF] RecalculateTopPosJob completed at "2024-02-25T15:33:17.5861166+03:00"
2024-02-25 15:33:25.276 +03:00 [INF] Start processing HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:33:25.280 +03:00 [INF] Sending HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:33:43.498 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/api/Auth - -
2024-02-25 15:33:43.506 +03:00 [WRN] Failed to determine the https port for redirect.
2024-02-25 15:33:43.605 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.AuthController.GetMe (TgCheckerApi)'
2024-02-25 15:33:43.630 +03:00 [INF] Route matched with {action = "GetMe", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[TgCheckerApi.Models.GetModels.UserProfileModel]] GetMe() on controller TgCheckerApi.Controllers.AuthController (TgCheckerApi).
2024-02-25 15:33:44.441 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2024-02-25 15:33:44.669 +03:00 [INF] Executed DbCommand (183ms) [Parameters=[@__uniqueKeyClaim_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t.avatar, t.chat_id, t.last_update, t.notification_settings, t.telegram_id, t.unique_key, t.username, t1.id, t1.channel_id, t1.user_id, t1.id0, t1.avatar, t1.bumps, t1.description, t1.flag, t1."Hidden", t1."IsPartner", t1.language, t1.last_bump, t1.members, t1.name, t1.notification_sent, t1.notifications, t1.promo_post, t1.promo_post_interval, t1.promo_post_last, t1.promo_post_sent, t1.promo_post_time, t1.telegram_id, t1."TopPos", t1."Url", t1."user", t1.id1, t1.channel, t1.tag, t1.id00, t1.text, t3.id, t3.channel_id, t3.content, t3.created_at, t3.parent_id, t3.rating, t3.user_id, t3.id0, t3.avatar, t3.bumps, t3.description, t3.flag, t3."Hidden", t3."IsPartner", t3.language, t3.last_bump, t3.members, t3.name, t3.notification_sent, t3.notifications, t3.promo_post, t3.promo_post_interval, t3.promo_post_last, t3.promo_post_sent, t3.promo_post_time, t3.telegram_id, t3."TopPos", t3."Url", t3."user"
FROM (
    SELECT u.id, u.avatar, u.chat_id, u.last_update, u.notification_settings, u.telegram_id, u.unique_key, u.username
    FROM "User" AS u
    WHERE u.unique_key = @__uniqueKeyClaim_0
    LIMIT 2
) AS t
LEFT JOIN (
    SELECT c.id, c.channel_id, c.user_id, c0.id AS id0, c0.avatar, c0.bumps, c0.description, c0.flag, c0."Hidden", c0."IsPartner", c0.language, c0.last_bump, c0.members, c0.name, c0.notification_sent, c0.notifications, c0.promo_post, c0.promo_post_interval, c0.promo_post_last, c0.promo_post_sent, c0.promo_post_time, c0.telegram_id, c0."TopPos", c0."Url", c0."user", t0.id AS id1, t0.channel, t0.tag, t0.id0 AS id00, t0.text
    FROM "ChannelAccess" AS c
    LEFT JOIN "Channel" AS c0 ON c.channel_id = c0.id
    LEFT JOIN (
        SELECT c1.id, c1.channel, c1.tag, t2.id AS id0, t2.text
        FROM "ChannelHasTag" AS c1
        LEFT JOIN "Tag" AS t2 ON c1.tag = t2.id
    ) AS t0 ON c0.id = t0.channel
) AS t1 ON t.id = t1.user_id
LEFT JOIN (
    SELECT c2.id, c2.channel_id, c2.content, c2.created_at, c2.parent_id, c2.rating, c2.user_id, c3.id AS id0, c3.avatar, c3.bumps, c3.description, c3.flag, c3."Hidden", c3."IsPartner", c3.language, c3.last_bump, c3.members, c3.name, c3.notification_sent, c3.notifications, c3.promo_post, c3.promo_post_interval, c3.promo_post_last, c3.promo_post_sent, c3.promo_post_time, c3.telegram_id, c3."TopPos", c3."Url", c3."user"
    FROM "Comment" AS c2
    INNER JOIN "Channel" AS c3 ON c2.channel_id = c3.id
) AS t3 ON t.id = t3.user_id
ORDER BY t.id, t1.id, t1.id0, t1.id1, t1.id00, t3.id
2024-02-25 15:33:44.771 +03:00 [INF] initializing user data update
2024-02-25 15:33:44.857 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.content, c.created_at, c.parent_id, c.rating, c.user_id
FROM "Comment" AS c
WHERE c.parent_id = @__p_0
2024-02-25 15:33:44.867 +03:00 [INF] Received request for getProfilePictureAndUsername. Request hash: 5ec5950f142bca89e2aa6cb4127bdea9391929bfdb585a0fda8bc0406276e946
2024-02-25 15:33:44.914 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.channel_id, r.comment_id, r.notification_sent, r.reason, r.report_time, r.report_type, r.staff_id, r.status, r.text, r.user_id
FROM "Report" AS r
WHERE r.comment_id = @__p_0
2024-02-25 15:33:44.924 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.content, c.created_at, c.parent_id, c.rating, c.user_id
FROM "Comment" AS c
WHERE c.parent_id = @__p_0
2024-02-25 15:33:44.927 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.channel_id, r.comment_id, r.notification_sent, r.reason, r.report_time, r.report_type, r.staff_id, r.status, r.text, r.user_id
FROM "Report" AS r
WHERE r.comment_id = @__p_0
2024-02-25 15:33:44.930 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.content, c.created_at, c.parent_id, c.rating, c.user_id
FROM "Comment" AS c
WHERE c.parent_id = @__p_0
2024-02-25 15:33:44.933 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.channel_id, r.comment_id, r.notification_sent, r.reason, r.report_time, r.report_type, r.staff_id, r.status, r.text, r.user_id
FROM "Report" AS r
WHERE r.comment_id = @__p_0
2024-02-25 15:33:44.957 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.user_id
FROM "ChannelAccess" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:33:44.986 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:33:44.995 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.content, c.created_at, c.parent_id, c.rating, c.user_id
FROM "Comment" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:33:45.048 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT n.id, n.channel_id, n.content, n.date, n.is_new, n.type_id, n.user_id
FROM "Notification" AS n
WHERE n.channel_id = @__p_0
2024-02-25 15:33:45.111 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT p.id, p.amount_currency, p.amount_value, p.capture, p.capture_json, p.captured_at, p.channel_id, p.client_ip, p.created_at, p.description, p.duration, p.expires_at, p.full_json, p.paid, p.payment_method, p.status, p.sub_given, p.subtype_id, p.user_id
FROM "Payments" AS p
WHERE p.channel_id = @__p_0
2024-02-25 15:33:45.195 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.channel_id, r.comment_id, r.notification_sent, r.reason, r.report_time, r.report_type, r.staff_id, r.status, r.text, r.user_id
FROM "Report" AS r
WHERE r.channel_id = @__p_0
2024-02-25 15:33:45.236 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.channel_id
FROM "StatisticsSheet" AS s
WHERE s.channel_id = @__p_0
2024-02-25 15:33:45.298 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t."autoRenewal", t."channelId", t.channel_name, t.discount, t.duration, t.expires, t.price, t.status, t.subscription_type_id, t."userId", t.username
FROM "TelegramPayments" AS t
WHERE t."channelId" = @__p_0
2024-02-25 15:33:45.302 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.user_id
FROM "ChannelAccess" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:33:45.305 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:33:45.320 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.content, c.created_at, c.parent_id, c.rating, c.user_id
FROM "Comment" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:33:45.325 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT n.id, n.channel_id, n.content, n.date, n.is_new, n.type_id, n.user_id
FROM "Notification" AS n
WHERE n.channel_id = @__p_0
2024-02-25 15:33:45.344 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT p.id, p.amount_currency, p.amount_value, p.capture, p.capture_json, p.captured_at, p.channel_id, p.client_ip, p.created_at, p.description, p.duration, p.expires_at, p.full_json, p.paid, p.payment_method, p.status, p.sub_given, p.subtype_id, p.user_id
FROM "Payments" AS p
WHERE p.channel_id = @__p_0
2024-02-25 15:33:45.350 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.channel_id, r.comment_id, r.notification_sent, r.reason, r.report_time, r.report_type, r.staff_id, r.status, r.text, r.user_id
FROM "Report" AS r
WHERE r.channel_id = @__p_0
2024-02-25 15:33:45.373 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.channel_id
FROM "StatisticsSheet" AS s
WHERE s.channel_id = @__p_0
2024-02-25 15:33:45.376 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t."autoRenewal", t."channelId", t.channel_name, t.discount, t.duration, t.expires, t.price, t.status, t.subscription_type_id, t."userId", t.username
FROM "TelegramPayments" AS t
WHERE t."channelId" = @__p_0
2024-02-25 15:33:45.492 +03:00 [ERR] Error in GetMe method
AutoMapper.AutoMapperMappingException: Error mapping types.

Mapping types:
List`1 -> IEnumerable`1
System.Collections.Generic.List`1[[TgCheckerApi.Models.BaseModels.Channel, TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]] -> System.Collections.Generic.IEnumerable`1[[TgCheckerApi.Models.GetModels.ChannelGetModel, TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]
 ---> AutoMapper.AutoMapperMappingException: Error mapping types.

Mapping types:
Channel -> ChannelGetModel
TgCheckerApi.Models.BaseModels.Channel -> TgCheckerApi.Models.GetModels.ChannelGetModel

Type Map configuration:
Channel -> ChannelGetModel
TgCheckerApi.Models.BaseModels.Channel -> TgCheckerApi.Models.GetModels.ChannelGetModel

Destination Member:
subType

 ---> AutoMapper.AutoMapperMappingException: Missing type map configuration or unsupported mapping.

Mapping types:
DateTime -> Int32
System.DateTime -> System.Int32

Destination Member:
subType

   at lambda_method914(Closure , DateTime , Int32 , ResolutionContext )
   at lambda_method631(Closure , Object , IEnumerable`1 , ResolutionContext )
   --- End of inner exception stack trace ---
   at lambda_method631(Closure , Object , IEnumerable`1 , ResolutionContext )
   --- End of inner exception stack trace ---
   at lambda_method631(Closure , Object , IEnumerable`1 , ResolutionContext )
   at TgCheckerApi.Controllers.AuthController.GetMe() in C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\Controllers\AuthController.cs:line 110
2024-02-25 15:33:45.559 +03:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2024-02-25 15:33:45.567 +03:00 [INF] Executed action TgCheckerApi.Controllers.AuthController.GetMe (TgCheckerApi) in 1929.3131ms
2024-02-25 15:33:45.570 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.AuthController.GetMe (TgCheckerApi)'
2024-02-25 15:33:45.588 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/api/Auth - - - 500 - text/plain;+charset=utf-8 2089.9954ms
2024-02-25 15:34:14.948 +03:00 [WRN] New task timed out. Hash: 5ec5950f142bca89e2aa6cb4127bdea9391929bfdb585a0fda8bc0406276e946
2024-02-25 15:34:14.950 +03:00 [WRN] Response is not in expected 'OkObjectResult' format or does not contain a string value.
2024-02-25 15:34:14.966 +03:00 [ERR] Invalid operation when updating user profile.
System.InvalidOperationException: Invalid response format.
   at TgCheckerApi.Services.WebSocketService.ResponseToObject[T](IActionResult response) in C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\Services\WebSocketService.cs:line 75
   at TgCheckerApi.Controllers.AuthController.UpdateUserProfileIfNeeded(User user) in C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\Controllers\AuthController.cs:line 146
2024-02-25 15:34:21.424 +03:00 [INF] User profile is available. Using 'C:\Users\timar\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-02-25 15:34:21.588 +03:00 [INF] Default Quartz.NET properties loaded from embedded resource file
2024-02-25 15:34:21.631 +03:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2024-02-25 15:34:21.637 +03:00 [INF] Quartz Scheduler created
2024-02-25 15:34:21.637 +03:00 [INF] RAMJobStore initialized.
2024-02-25 15:34:21.639 +03:00 [INF] Quartz Scheduler 3.8.0.0 - 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2024-02-25 15:34:21.640 +03:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2024-02-25 15:34:21.640 +03:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2024-02-25 15:34:21.642 +03:00 [INF] JobFactory set to: TgCheckerApi.Job.QuartzJobFactory
2024-02-25 15:34:21.689 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-02-25 15:34:21.798 +03:00 [INF] Now listening on: http://localhost:7256
2024-02-25 15:34:21.800 +03:00 [INF] Now listening on: http://localhost:5244
2024-02-25 15:34:21.803 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-02-25 15:34:21.805 +03:00 [INF] Hosting environment: Development
2024-02-25 15:34:21.806 +03:00 [INF] Content root path: C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\
2024-02-25 15:34:21.893 +03:00 [INF] RecalculateTopPosJob started at "2024-02-25T15:34:21.8934977+03:00"
2024-02-25 15:34:22.349 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/index.html - -
2024-02-25 15:34:22.617 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/index.html - - - 200 - text/html;charset=utf-8 270.8473ms
2024-02-25 15:34:22.625 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_vs/browserLink - -
2024-02-25 15:34:22.626 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - -
2024-02-25 15:34:22.632 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - - - 200 12356 application/javascript;+charset=utf-8 5.9977ms
2024-02-25 15:34:22.646 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 21.2295ms
2024-02-25 15:34:22.706 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - -
2024-02-25 15:34:22.844 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 137.6574ms
2024-02-25 15:34:23.482 +03:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
ORDER BY c.bumps DESC
2024-02-25 15:34:23.658 +03:00 [INF] RecalculateTopPosJob completed at "2024-02-25T15:34:23.6589258+03:00"
2024-02-25 15:34:31.890 +03:00 [INF] Start processing HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:34:31.894 +03:00 [INF] Sending HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:34:35.280 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/api/Auth - -
2024-02-25 15:34:35.289 +03:00 [WRN] Failed to determine the https port for redirect.
2024-02-25 15:34:35.378 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.AuthController.GetMe (TgCheckerApi)'
2024-02-25 15:34:35.406 +03:00 [INF] Route matched with {action = "GetMe", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[TgCheckerApi.Models.GetModels.UserProfileModel]] GetMe() on controller TgCheckerApi.Controllers.AuthController (TgCheckerApi).
2024-02-25 15:34:36.032 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2024-02-25 15:34:36.098 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@__uniqueKeyClaim_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t.avatar, t.chat_id, t.last_update, t.notification_settings, t.telegram_id, t.unique_key, t.username, t1.id, t1.channel_id, t1.user_id, t1.id0, t1.avatar, t1.bumps, t1.description, t1.flag, t1."Hidden", t1."IsPartner", t1.language, t1.last_bump, t1.members, t1.name, t1.notification_sent, t1.notifications, t1.promo_post, t1.promo_post_interval, t1.promo_post_last, t1.promo_post_sent, t1.promo_post_time, t1.telegram_id, t1."TopPos", t1."Url", t1."user", t1.id1, t1.channel, t1.tag, t1.id00, t1.text, t3.id, t3.channel_id, t3.content, t3.created_at, t3.parent_id, t3.rating, t3.user_id, t3.id0, t3.avatar, t3.bumps, t3.description, t3.flag, t3."Hidden", t3."IsPartner", t3.language, t3.last_bump, t3.members, t3.name, t3.notification_sent, t3.notifications, t3.promo_post, t3.promo_post_interval, t3.promo_post_last, t3.promo_post_sent, t3.promo_post_time, t3.telegram_id, t3."TopPos", t3."Url", t3."user"
FROM (
    SELECT u.id, u.avatar, u.chat_id, u.last_update, u.notification_settings, u.telegram_id, u.unique_key, u.username
    FROM "User" AS u
    WHERE u.unique_key = @__uniqueKeyClaim_0
    LIMIT 2
) AS t
LEFT JOIN (
    SELECT c.id, c.channel_id, c.user_id, c0.id AS id0, c0.avatar, c0.bumps, c0.description, c0.flag, c0."Hidden", c0."IsPartner", c0.language, c0.last_bump, c0.members, c0.name, c0.notification_sent, c0.notifications, c0.promo_post, c0.promo_post_interval, c0.promo_post_last, c0.promo_post_sent, c0.promo_post_time, c0.telegram_id, c0."TopPos", c0."Url", c0."user", t0.id AS id1, t0.channel, t0.tag, t0.id0 AS id00, t0.text
    FROM "ChannelAccess" AS c
    LEFT JOIN "Channel" AS c0 ON c.channel_id = c0.id
    LEFT JOIN (
        SELECT c1.id, c1.channel, c1.tag, t2.id AS id0, t2.text
        FROM "ChannelHasTag" AS c1
        LEFT JOIN "Tag" AS t2 ON c1.tag = t2.id
    ) AS t0 ON c0.id = t0.channel
) AS t1 ON t.id = t1.user_id
LEFT JOIN (
    SELECT c2.id, c2.channel_id, c2.content, c2.created_at, c2.parent_id, c2.rating, c2.user_id, c3.id AS id0, c3.avatar, c3.bumps, c3.description, c3.flag, c3."Hidden", c3."IsPartner", c3.language, c3.last_bump, c3.members, c3.name, c3.notification_sent, c3.notifications, c3.promo_post, c3.promo_post_interval, c3.promo_post_last, c3.promo_post_sent, c3.promo_post_time, c3.telegram_id, c3."TopPos", c3."Url", c3."user"
    FROM "Comment" AS c2
    INNER JOIN "Channel" AS c3 ON c2.channel_id = c3.id
) AS t3 ON t.id = t3.user_id
ORDER BY t.id, t1.id, t1.id0, t1.id1, t1.id00, t3.id
2024-02-25 15:34:36.187 +03:00 [INF] initializing user data update
2024-02-25 15:34:36.262 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.content, c.created_at, c.parent_id, c.rating, c.user_id
FROM "Comment" AS c
WHERE c.parent_id = @__p_0
2024-02-25 15:34:36.293 +03:00 [INF] Received request for getProfilePictureAndUsername. Request hash: 5ec5950f142bca89e2aa6cb4127bdea9391929bfdb585a0fda8bc0406276e946
2024-02-25 15:34:36.303 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.channel_id, r.comment_id, r.notification_sent, r.reason, r.report_time, r.report_type, r.staff_id, r.status, r.text, r.user_id
FROM "Report" AS r
WHERE r.comment_id = @__p_0
2024-02-25 15:34:36.312 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.content, c.created_at, c.parent_id, c.rating, c.user_id
FROM "Comment" AS c
WHERE c.parent_id = @__p_0
2024-02-25 15:34:36.315 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.channel_id, r.comment_id, r.notification_sent, r.reason, r.report_time, r.report_type, r.staff_id, r.status, r.text, r.user_id
FROM "Report" AS r
WHERE r.comment_id = @__p_0
2024-02-25 15:34:36.317 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.content, c.created_at, c.parent_id, c.rating, c.user_id
FROM "Comment" AS c
WHERE c.parent_id = @__p_0
2024-02-25 15:34:36.320 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.channel_id, r.comment_id, r.notification_sent, r.reason, r.report_time, r.report_type, r.staff_id, r.status, r.text, r.user_id
FROM "Report" AS r
WHERE r.comment_id = @__p_0
2024-02-25 15:34:36.343 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.user_id
FROM "ChannelAccess" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:34:36.364 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:34:36.372 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.content, c.created_at, c.parent_id, c.rating, c.user_id
FROM "Comment" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:34:36.398 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT n.id, n.channel_id, n.content, n.date, n.is_new, n.type_id, n.user_id
FROM "Notification" AS n
WHERE n.channel_id = @__p_0
2024-02-25 15:34:36.425 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT p.id, p.amount_currency, p.amount_value, p.capture, p.capture_json, p.captured_at, p.channel_id, p.client_ip, p.created_at, p.description, p.duration, p.expires_at, p.full_json, p.paid, p.payment_method, p.status, p.sub_given, p.subtype_id, p.user_id
FROM "Payments" AS p
WHERE p.channel_id = @__p_0
2024-02-25 15:34:36.501 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.channel_id, r.comment_id, r.notification_sent, r.reason, r.report_time, r.report_type, r.staff_id, r.status, r.text, r.user_id
FROM "Report" AS r
WHERE r.channel_id = @__p_0
2024-02-25 15:34:36.533 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.channel_id
FROM "StatisticsSheet" AS s
WHERE s.channel_id = @__p_0
2024-02-25 15:34:36.570 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t."autoRenewal", t."channelId", t.channel_name, t.discount, t.duration, t.expires, t.price, t.status, t.subscription_type_id, t."userId", t.username
FROM "TelegramPayments" AS t
WHERE t."channelId" = @__p_0
2024-02-25 15:34:36.575 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.user_id
FROM "ChannelAccess" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:34:36.578 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:34:36.592 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.content, c.created_at, c.parent_id, c.rating, c.user_id
FROM "Comment" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:34:36.595 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT n.id, n.channel_id, n.content, n.date, n.is_new, n.type_id, n.user_id
FROM "Notification" AS n
WHERE n.channel_id = @__p_0
2024-02-25 15:34:36.616 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT p.id, p.amount_currency, p.amount_value, p.capture, p.capture_json, p.captured_at, p.channel_id, p.client_ip, p.created_at, p.description, p.duration, p.expires_at, p.full_json, p.paid, p.payment_method, p.status, p.sub_given, p.subtype_id, p.user_id
FROM "Payments" AS p
WHERE p.channel_id = @__p_0
2024-02-25 15:34:36.622 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.channel_id, r.comment_id, r.notification_sent, r.reason, r.report_time, r.report_type, r.staff_id, r.status, r.text, r.user_id
FROM "Report" AS r
WHERE r.channel_id = @__p_0
2024-02-25 15:34:36.647 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.channel_id
FROM "StatisticsSheet" AS s
WHERE s.channel_id = @__p_0
2024-02-25 15:34:36.651 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t."autoRenewal", t."channelId", t.channel_name, t.discount, t.duration, t.expires, t.price, t.status, t.subscription_type_id, t."userId", t.username
FROM "TelegramPayments" AS t
WHERE t."channelId" = @__p_0
2024-02-25 15:34:36.657 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.user_id
FROM "ChannelAccess" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:34:36.660 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:34:36.664 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.content, c.created_at, c.parent_id, c.rating, c.user_id
FROM "Comment" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:34:36.666 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT n.id, n.channel_id, n.content, n.date, n.is_new, n.type_id, n.user_id
FROM "Notification" AS n
WHERE n.channel_id = @__p_0
2024-02-25 15:34:36.670 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT p.id, p.amount_currency, p.amount_value, p.capture, p.capture_json, p.captured_at, p.channel_id, p.client_ip, p.created_at, p.description, p.duration, p.expires_at, p.full_json, p.paid, p.payment_method, p.status, p.sub_given, p.subtype_id, p.user_id
FROM "Payments" AS p
WHERE p.channel_id = @__p_0
2024-02-25 15:34:36.672 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.channel_id, r.comment_id, r.notification_sent, r.reason, r.report_time, r.report_type, r.staff_id, r.status, r.text, r.user_id
FROM "Report" AS r
WHERE r.channel_id = @__p_0
2024-02-25 15:34:36.675 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.channel_id
FROM "StatisticsSheet" AS s
WHERE s.channel_id = @__p_0
2024-02-25 15:34:36.678 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t."autoRenewal", t."channelId", t.channel_name, t.discount, t.duration, t.expires, t.price, t.status, t.subscription_type_id, t."userId", t.username
FROM "TelegramPayments" AS t
WHERE t."channelId" = @__p_0
2024-02-25 15:34:36.694 +03:00 [INF] Executing OkObjectResult, writing value of type 'TgCheckerApi.Models.GetModels.UserProfileModel'.
2024-02-25 15:34:36.771 +03:00 [INF] Executed action TgCheckerApi.Controllers.AuthController.GetMe (TgCheckerApi) in 1356.4279ms
2024-02-25 15:34:36.775 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.AuthController.GetMe (TgCheckerApi)'
2024-02-25 15:34:36.791 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/api/Auth - - - 200 33440 application/json;+charset=utf-8 1510.7396ms
2024-02-25 15:35:06.336 +03:00 [WRN] New task timed out. Hash: 5ec5950f142bca89e2aa6cb4127bdea9391929bfdb585a0fda8bc0406276e946
2024-02-25 15:35:06.337 +03:00 [WRN] Response is not in expected 'OkObjectResult' format or does not contain a string value.
2024-02-25 15:35:06.361 +03:00 [ERR] Invalid operation when updating user profile.
System.InvalidOperationException: Invalid response format.
   at TgCheckerApi.Services.WebSocketService.ResponseToObject[T](IActionResult response) in C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\Services\WebSocketService.cs:line 75
   at TgCheckerApi.Controllers.AuthController.UpdateUserProfileIfNeeded(User user) in C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\Controllers\AuthController.cs:line 146
2024-02-25 15:35:56.954 +03:00 [INF] User profile is available. Using 'C:\Users\timar\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-02-25 15:35:57.109 +03:00 [INF] Default Quartz.NET properties loaded from embedded resource file
2024-02-25 15:35:57.154 +03:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2024-02-25 15:35:57.156 +03:00 [INF] Quartz Scheduler created
2024-02-25 15:35:57.156 +03:00 [INF] RAMJobStore initialized.
2024-02-25 15:35:57.158 +03:00 [INF] Quartz Scheduler 3.8.0.0 - 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2024-02-25 15:35:57.158 +03:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2024-02-25 15:35:57.163 +03:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2024-02-25 15:35:57.164 +03:00 [INF] JobFactory set to: TgCheckerApi.Job.QuartzJobFactory
2024-02-25 15:35:57.207 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-02-25 15:35:57.307 +03:00 [INF] Now listening on: http://localhost:7256
2024-02-25 15:35:57.308 +03:00 [INF] Now listening on: http://localhost:5244
2024-02-25 15:35:57.311 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-02-25 15:35:57.312 +03:00 [INF] Hosting environment: Development
2024-02-25 15:35:57.313 +03:00 [INF] Content root path: C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\
2024-02-25 15:35:57.399 +03:00 [INF] RecalculateTopPosJob started at "2024-02-25T15:35:57.3986340+03:00"
2024-02-25 15:35:57.814 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/index.html - -
2024-02-25 15:35:58.083 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/index.html - - - 200 - text/html;charset=utf-8 272.1026ms
2024-02-25 15:35:58.090 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_vs/browserLink - -
2024-02-25 15:35:58.092 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - -
2024-02-25 15:35:58.099 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - - - 200 12356 application/javascript;+charset=utf-8 6.7178ms
2024-02-25 15:35:58.109 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 18.6618ms
2024-02-25 15:35:58.172 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - -
2024-02-25 15:35:58.301 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 129.4618ms
2024-02-25 15:35:58.912 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
ORDER BY c.bumps DESC
2024-02-25 15:35:59.094 +03:00 [INF] RecalculateTopPosJob completed at "2024-02-25T15:35:59.0945345+03:00"
2024-02-25 15:36:07.422 +03:00 [INF] Start processing HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:36:07.426 +03:00 [INF] Sending HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:36:10.624 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/api/Auth - -
2024-02-25 15:36:10.633 +03:00 [WRN] Failed to determine the https port for redirect.
2024-02-25 15:36:10.744 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.AuthController.GetMe (TgCheckerApi)'
2024-02-25 15:36:10.774 +03:00 [INF] Route matched with {action = "GetMe", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[TgCheckerApi.Models.GetModels.UserProfileModel]] GetMe() on controller TgCheckerApi.Controllers.AuthController (TgCheckerApi).
2024-02-25 15:36:11.407 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2024-02-25 15:36:11.470 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@__uniqueKeyClaim_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t.avatar, t.chat_id, t.last_update, t.notification_settings, t.telegram_id, t.unique_key, t.username, t1.id, t1.channel_id, t1.user_id, t1.id0, t1.avatar, t1.bumps, t1.description, t1.flag, t1."Hidden", t1."IsPartner", t1.language, t1.last_bump, t1.members, t1.name, t1.notification_sent, t1.notifications, t1.promo_post, t1.promo_post_interval, t1.promo_post_last, t1.promo_post_sent, t1.promo_post_time, t1.telegram_id, t1."TopPos", t1."Url", t1."user", t1.id1, t1.channel, t1.tag, t1.id00, t1.text, t3.id, t3.channel_id, t3.content, t3.created_at, t3.parent_id, t3.rating, t3.user_id, t3.id0, t3.avatar, t3.bumps, t3.description, t3.flag, t3."Hidden", t3."IsPartner", t3.language, t3.last_bump, t3.members, t3.name, t3.notification_sent, t3.notifications, t3.promo_post, t3.promo_post_interval, t3.promo_post_last, t3.promo_post_sent, t3.promo_post_time, t3.telegram_id, t3."TopPos", t3."Url", t3."user"
FROM (
    SELECT u.id, u.avatar, u.chat_id, u.last_update, u.notification_settings, u.telegram_id, u.unique_key, u.username
    FROM "User" AS u
    WHERE u.unique_key = @__uniqueKeyClaim_0
    LIMIT 2
) AS t
LEFT JOIN (
    SELECT c.id, c.channel_id, c.user_id, c0.id AS id0, c0.avatar, c0.bumps, c0.description, c0.flag, c0."Hidden", c0."IsPartner", c0.language, c0.last_bump, c0.members, c0.name, c0.notification_sent, c0.notifications, c0.promo_post, c0.promo_post_interval, c0.promo_post_last, c0.promo_post_sent, c0.promo_post_time, c0.telegram_id, c0."TopPos", c0."Url", c0."user", t0.id AS id1, t0.channel, t0.tag, t0.id0 AS id00, t0.text
    FROM "ChannelAccess" AS c
    LEFT JOIN "Channel" AS c0 ON c.channel_id = c0.id
    LEFT JOIN (
        SELECT c1.id, c1.channel, c1.tag, t2.id AS id0, t2.text
        FROM "ChannelHasTag" AS c1
        LEFT JOIN "Tag" AS t2 ON c1.tag = t2.id
    ) AS t0 ON c0.id = t0.channel
) AS t1 ON t.id = t1.user_id
LEFT JOIN (
    SELECT c2.id, c2.channel_id, c2.content, c2.created_at, c2.parent_id, c2.rating, c2.user_id, c3.id AS id0, c3.avatar, c3.bumps, c3.description, c3.flag, c3."Hidden", c3."IsPartner", c3.language, c3.last_bump, c3.members, c3.name, c3.notification_sent, c3.notifications, c3.promo_post, c3.promo_post_interval, c3.promo_post_last, c3.promo_post_sent, c3.promo_post_time, c3.telegram_id, c3."TopPos", c3."Url", c3."user"
    FROM "Comment" AS c2
    INNER JOIN "Channel" AS c3 ON c2.channel_id = c3.id
) AS t3 ON t.id = t3.user_id
ORDER BY t.id, t1.id, t1.id0, t1.id1, t1.id00, t3.id
2024-02-25 15:36:11.568 +03:00 [INF] initializing user data update
2024-02-25 15:36:11.646 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.content, c.created_at, c.parent_id, c.rating, c.user_id
FROM "Comment" AS c
WHERE c.parent_id = @__p_0
2024-02-25 15:36:11.657 +03:00 [INF] Received request for getProfilePictureAndUsername. Request hash: 5ec5950f142bca89e2aa6cb4127bdea9391929bfdb585a0fda8bc0406276e946
2024-02-25 15:36:11.691 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.channel_id, r.comment_id, r.notification_sent, r.reason, r.report_time, r.report_type, r.staff_id, r.status, r.text, r.user_id
FROM "Report" AS r
WHERE r.comment_id = @__p_0
2024-02-25 15:36:11.700 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.content, c.created_at, c.parent_id, c.rating, c.user_id
FROM "Comment" AS c
WHERE c.parent_id = @__p_0
2024-02-25 15:36:11.702 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.channel_id, r.comment_id, r.notification_sent, r.reason, r.report_time, r.report_type, r.staff_id, r.status, r.text, r.user_id
FROM "Report" AS r
WHERE r.comment_id = @__p_0
2024-02-25 15:36:11.704 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.content, c.created_at, c.parent_id, c.rating, c.user_id
FROM "Comment" AS c
WHERE c.parent_id = @__p_0
2024-02-25 15:36:11.706 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.channel_id, r.comment_id, r.notification_sent, r.reason, r.report_time, r.report_type, r.staff_id, r.status, r.text, r.user_id
FROM "Report" AS r
WHERE r.comment_id = @__p_0
2024-02-25 15:36:11.729 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.user_id
FROM "ChannelAccess" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:36:11.749 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:36:11.757 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.content, c.created_at, c.parent_id, c.rating, c.user_id
FROM "Comment" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:36:11.780 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT n.id, n.channel_id, n.content, n.date, n.is_new, n.type_id, n.user_id
FROM "Notification" AS n
WHERE n.channel_id = @__p_0
2024-02-25 15:36:11.808 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT p.id, p.amount_currency, p.amount_value, p.capture, p.capture_json, p.captured_at, p.channel_id, p.client_ip, p.created_at, p.description, p.duration, p.expires_at, p.full_json, p.paid, p.payment_method, p.status, p.sub_given, p.subtype_id, p.user_id
FROM "Payments" AS p
WHERE p.channel_id = @__p_0
2024-02-25 15:36:11.879 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.channel_id, r.comment_id, r.notification_sent, r.reason, r.report_time, r.report_type, r.staff_id, r.status, r.text, r.user_id
FROM "Report" AS r
WHERE r.channel_id = @__p_0
2024-02-25 15:36:11.910 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.channel_id
FROM "StatisticsSheet" AS s
WHERE s.channel_id = @__p_0
2024-02-25 15:36:11.947 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t."autoRenewal", t."channelId", t.channel_name, t.discount, t.duration, t.expires, t.price, t.status, t.subscription_type_id, t."userId", t.username
FROM "TelegramPayments" AS t
WHERE t."channelId" = @__p_0
2024-02-25 15:36:11.952 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.user_id
FROM "ChannelAccess" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:36:11.956 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:36:11.970 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.content, c.created_at, c.parent_id, c.rating, c.user_id
FROM "Comment" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:36:11.973 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT n.id, n.channel_id, n.content, n.date, n.is_new, n.type_id, n.user_id
FROM "Notification" AS n
WHERE n.channel_id = @__p_0
2024-02-25 15:36:11.993 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT p.id, p.amount_currency, p.amount_value, p.capture, p.capture_json, p.captured_at, p.channel_id, p.client_ip, p.created_at, p.description, p.duration, p.expires_at, p.full_json, p.paid, p.payment_method, p.status, p.sub_given, p.subtype_id, p.user_id
FROM "Payments" AS p
WHERE p.channel_id = @__p_0
2024-02-25 15:36:11.999 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.channel_id, r.comment_id, r.notification_sent, r.reason, r.report_time, r.report_type, r.staff_id, r.status, r.text, r.user_id
FROM "Report" AS r
WHERE r.channel_id = @__p_0
2024-02-25 15:36:12.021 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.channel_id
FROM "StatisticsSheet" AS s
WHERE s.channel_id = @__p_0
2024-02-25 15:36:12.024 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t."autoRenewal", t."channelId", t.channel_name, t.discount, t.duration, t.expires, t.price, t.status, t.subscription_type_id, t."userId", t.username
FROM "TelegramPayments" AS t
WHERE t."channelId" = @__p_0
2024-02-25 15:36:12.029 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.user_id
FROM "ChannelAccess" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:36:12.032 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.expires, c.type_id
FROM "ChannelHasSubscription" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:36:12.035 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.channel_id, c.content, c.created_at, c.parent_id, c.rating, c.user_id
FROM "Comment" AS c
WHERE c.channel_id = @__p_0
2024-02-25 15:36:12.038 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT n.id, n.channel_id, n.content, n.date, n.is_new, n.type_id, n.user_id
FROM "Notification" AS n
WHERE n.channel_id = @__p_0
2024-02-25 15:36:12.040 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT p.id, p.amount_currency, p.amount_value, p.capture, p.capture_json, p.captured_at, p.channel_id, p.client_ip, p.created_at, p.description, p.duration, p.expires_at, p.full_json, p.paid, p.payment_method, p.status, p.sub_given, p.subtype_id, p.user_id
FROM "Payments" AS p
WHERE p.channel_id = @__p_0
2024-02-25 15:36:12.044 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.channel_id, r.comment_id, r.notification_sent, r.reason, r.report_time, r.report_type, r.staff_id, r.status, r.text, r.user_id
FROM "Report" AS r
WHERE r.channel_id = @__p_0
2024-02-25 15:36:12.046 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.channel_id
FROM "StatisticsSheet" AS s
WHERE s.channel_id = @__p_0
2024-02-25 15:36:12.050 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t."autoRenewal", t."channelId", t.channel_name, t.discount, t.duration, t.expires, t.price, t.status, t.subscription_type_id, t."userId", t.username
FROM "TelegramPayments" AS t
WHERE t."channelId" = @__p_0
2024-02-25 15:36:12.064 +03:00 [INF] Executing OkObjectResult, writing value of type 'TgCheckerApi.Models.GetModels.UserProfileModel'.
2024-02-25 15:36:12.142 +03:00 [INF] Executed action TgCheckerApi.Controllers.AuthController.GetMe (TgCheckerApi) in 1359.0641ms
2024-02-25 15:36:12.146 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.AuthController.GetMe (TgCheckerApi)'
2024-02-25 15:36:12.163 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/api/Auth - - - 200 33406 application/json;+charset=utf-8 1538.3879ms
2024-02-25 15:38:29.365 +03:00 [INF] User profile is available. Using 'C:\Users\timar\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-02-25 15:38:29.528 +03:00 [INF] Default Quartz.NET properties loaded from embedded resource file
2024-02-25 15:38:29.589 +03:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2024-02-25 15:38:29.594 +03:00 [INF] Quartz Scheduler created
2024-02-25 15:38:29.595 +03:00 [INF] RAMJobStore initialized.
2024-02-25 15:38:29.596 +03:00 [INF] Quartz Scheduler 3.8.0.0 - 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2024-02-25 15:38:29.597 +03:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2024-02-25 15:38:29.598 +03:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2024-02-25 15:38:29.599 +03:00 [INF] JobFactory set to: TgCheckerApi.Job.QuartzJobFactory
2024-02-25 15:38:29.645 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-02-25 15:38:29.731 +03:00 [INF] Now listening on: http://localhost:7256
2024-02-25 15:38:29.732 +03:00 [INF] Now listening on: http://localhost:5244
2024-02-25 15:38:29.739 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-02-25 15:38:29.740 +03:00 [INF] Hosting environment: Development
2024-02-25 15:38:29.740 +03:00 [INF] Content root path: C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\
2024-02-25 15:38:29.825 +03:00 [INF] RecalculateTopPosJob started at "2024-02-25T15:38:29.8254531+03:00"
2024-02-25 15:38:30.405 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/index.html - -
2024-02-25 15:38:30.665 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/index.html - - - 200 - text/html;charset=utf-8 262.2686ms
2024-02-25 15:38:30.673 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_vs/browserLink - -
2024-02-25 15:38:30.676 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - -
2024-02-25 15:38:30.683 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_framework/aspnetcore-browser-refresh.js - - - 200 12356 application/javascript;+charset=utf-8 6.3390ms
2024-02-25 15:38:30.693 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 20.0301ms
2024-02-25 15:38:30.754 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - -
2024-02-25 15:38:30.885 +03:00 [INF] Request finished HTTP/1.1 GET http://localhost:7256/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 130.8806ms
2024-02-25 15:38:31.515 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
ORDER BY c.bumps DESC
2024-02-25 15:38:31.690 +03:00 [INF] RecalculateTopPosJob completed at "2024-02-25T15:38:31.6902788+03:00"
2024-02-25 15:38:37.830 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:7256/BotHub/negotiate?negotiateVersion=0 - 0
2024-02-25 15:38:37.837 +03:00 [WRN] Failed to determine the https port for redirect.
2024-02-25 15:38:37.936 +03:00 [INF] Executing endpoint '/BotHub/negotiate'
2024-02-25 15:38:37.959 +03:00 [INF] Executed endpoint '/BotHub/negotiate'
2024-02-25 15:38:37.962 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:7256/BotHub/negotiate?negotiateVersion=0 - 0 - 200 273 application/json 132.0682ms
2024-02-25 15:38:37.974 +03:00 [INF] Request starting HTTP/1.1 GET http://localhost:7256/BotHub?id=ev7D3enmn6NkNbb1AdRf7Q - -
2024-02-25 15:38:37.977 +03:00 [INF] Executing endpoint '/BotHub'
2024-02-25 15:38:39.835 +03:00 [INF] Start processing HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:38:39.838 +03:00 [INF] Sending HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:38:40.147 +03:00 [INF] Received HTTP response headers after 302.5994ms - 200
2024-02-25 15:38:40.150 +03:00 [INF] End processing HTTP request after 322.1112ms - 200
2024-02-25 15:38:40.154 +03:00 [INF] Successfully processed all channels via HTTP request at: {DateTime.UtcNow}
2024-02-25 15:38:53.997 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:7256/api/Bot/getMonthlyViews application/json-patch+json 36
2024-02-25 15:38:54.001 +03:00 [INF] CORS policy execution successful.
2024-02-25 15:38:54.008 +03:00 [INF] Executing endpoint 'TgCheckerApi.Controllers.BotController.CallGetMonthViews (TgCheckerApi)'
2024-02-25 15:38:54.042 +03:00 [INF] Route matched with {action = "CallGetMonthViews", controller = "Bot"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CallGetMonthViews(MonthViewsRequest) on controller TgCheckerApi.Controllers.BotController (TgCheckerApi).
2024-02-25 15:38:54.137 +03:00 [INF] Starting CallGetMonthViews method for ChannelId: 80
2024-02-25 15:38:54.270 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
WHERE c.id = @__p_0
LIMIT 1
2024-02-25 15:38:54.480 +03:00 [INF] Executed DbCommand (53ms) [Parameters=[@__monthViewsRequest_ChannelId_0='?' (DbType = Int32), @__startDate_1='?' (DbType = DateTime), @__endDate_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT m.id, m.date, m.last_message_id, m.sheet, m.updated, m.views
FROM "Channel" AS c
INNER JOIN "StatisticsSheet" AS s ON c.id = s.channel_id
INNER JOIN "MonthViewsRecord" AS m ON s.id = m.sheet
WHERE c.id = @__monthViewsRequest_ChannelId_0 AND m.date >= @__startDate_1 AND m.date <= @__endDate_2
ORDER BY m.date
2024-02-25 15:38:54.500 +03:00 [INF] Starting IsUpdateRequiredForMonth method.
2024-02-25 15:38:54.501 +03:00 [INF] Parameters: ChannelId=80, Months=1
2024-02-25 15:38:54.501 +03:00 [INF] Outdated threshold set to 360 minutes.
2024-02-25 15:38:54.561 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[@__monthViewsRequest_ChannelId_0='?' (DbType = Int32), @__year_1='?' (DbType = Int32), @__month_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT m.id, m.date, m.last_message_id, m.sheet, m.updated, m.views
FROM "Channel" AS c
INNER JOIN "StatisticsSheet" AS s ON c.id = s.channel_id
INNER JOIN "MonthViewsRecord" AS m ON s.id = m.sheet
WHERE c.id = @__monthViewsRequest_ChannelId_0 AND date_part('year', m.date)::int = @__year_1 AND date_part('month', m.date)::int = @__month_2
ORDER BY m.date DESC
LIMIT 1
2024-02-25 15:38:54.565 +03:00 [INF] Update required for the latest month: True
2024-02-25 15:38:54.565 +03:00 [INF] First month data is outdated for ChannelId: 80. Initiating background update.
2024-02-25 15:38:54.579 +03:00 [INF] Received request for getMonthlyViews. Request hash: 0200973d437c04939397b6c5e5069c316523e0bafd385ec4d84de9dba870c1ed
2024-02-25 15:38:54.605 +03:00 [INF] Returning data for ChannelId: 80 with 1 month view counts
2024-02-25 15:38:54.615 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[TgCheckerApi.Models.BaseModels.MonthViewsRecord, TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[<>f__AnonymousType5`2[[System.Int32, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-02-25 15:38:54.642 +03:00 [INF] Executed action TgCheckerApi.Controllers.BotController.CallGetMonthViews (TgCheckerApi) in 590.9906ms
2024-02-25 15:38:54.644 +03:00 [INF] Executed endpoint 'TgCheckerApi.Controllers.BotController.CallGetMonthViews (TgCheckerApi)'
2024-02-25 15:38:54.661 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:7256/api/Bot/getMonthlyViews application/json-patch+json 36 - 200 46 application/json;+charset=utf-8 664.2871ms
2024-02-25 15:39:57.912 +03:00 [INF] User profile is available. Using 'C:\Users\timar\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-02-25 15:39:58.064 +03:00 [INF] Default Quartz.NET properties loaded from embedded resource file
2024-02-25 15:39:58.104 +03:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2024-02-25 15:39:58.109 +03:00 [INF] Quartz Scheduler created
2024-02-25 15:39:58.110 +03:00 [INF] RAMJobStore initialized.
2024-02-25 15:39:58.111 +03:00 [INF] Quartz Scheduler 3.8.0.0 - 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2024-02-25 15:39:58.112 +03:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2024-02-25 15:39:58.112 +03:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2024-02-25 15:39:58.113 +03:00 [INF] JobFactory set to: TgCheckerApi.Job.QuartzJobFactory
2024-02-25 15:39:58.156 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-02-25 15:39:58.287 +03:00 [INF] Now listening on: https://localhost:7256
2024-02-25 15:39:58.288 +03:00 [INF] Now listening on: https://localhost:5244
2024-02-25 15:39:58.291 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-02-25 15:39:58.292 +03:00 [INF] Hosting environment: Development
2024-02-25 15:39:58.292 +03:00 [INF] Content root path: C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\
2024-02-25 15:39:58.350 +03:00 [INF] RecalculateTopPosJob started at "2024-02-25T15:39:58.3497308+03:00"
2024-02-25 15:39:58.698 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/swagger - -
2024-02-25 15:39:58.751 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/swagger - - - 301 0 - 55.7396ms
2024-02-25 15:39:58.762 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/swagger/index.html - -
2024-02-25 15:39:58.976 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/swagger/index.html - - - 200 - text/html;charset=utf-8 214.3679ms
2024-02-25 15:39:58.982 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/swagger/swagger-ui-standalone-preset.js - -
2024-02-25 15:39:58.982 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/_framework/aspnetcore-browser-refresh.js - -
2024-02-25 15:39:58.982 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/swagger/swagger-ui.css - -
2024-02-25 15:39:58.982 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/swagger/swagger-ui-bundle.js - -
2024-02-25 15:39:58.987 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/_framework/aspnetcore-browser-refresh.js - - - 200 12356 application/javascript;+charset=utf-8 4.8608ms
2024-02-25 15:39:58.990 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/_vs/browserLink - -
2024-02-25 15:39:58.998 +03:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2024-02-25 15:39:59.004 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/swagger/swagger-ui.css - - - 200 144929 text/css 22.1765ms
2024-02-25 15:39:59.010 +03:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2024-02-25 15:39:59.011 +03:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2024-02-25 15:39:59.012 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/swagger/swagger-ui-standalone-preset.js - - - 200 312163 application/javascript 29.9181ms
2024-02-25 15:39:59.013 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/swagger/swagger-ui-bundle.js - - - 200 1061536 application/javascript 31.1330ms
2024-02-25 15:39:59.014 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 23.3850ms
2024-02-25 15:39:59.149 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/swagger/v1/swagger.json - -
2024-02-25 15:39:59.164 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/swagger/favicon-32x32.png - -
2024-02-25 15:39:59.166 +03:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2024-02-25 15:39:59.167 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/swagger/favicon-32x32.png - - - 200 628 image/png 3.1326ms
2024-02-25 15:39:59.287 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 137.7811ms
2024-02-25 15:40:00.130 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
ORDER BY c.bumps DESC
2024-02-25 15:40:00.310 +03:00 [INF] RecalculateTopPosJob completed at "2024-02-25T15:40:00.3107542+03:00"
2024-02-25 15:40:08.380 +03:00 [INF] Start processing HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:40:08.384 +03:00 [INF] Sending HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:42:28.117 +03:00 [INF] User profile is available. Using 'C:\Users\timar\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-02-25 15:42:28.284 +03:00 [INF] Default Quartz.NET properties loaded from embedded resource file
2024-02-25 15:42:28.324 +03:00 [INF] Initialized Scheduler Signaller of type: Quartz.Core.SchedulerSignalerImpl
2024-02-25 15:42:28.328 +03:00 [INF] Quartz Scheduler created
2024-02-25 15:42:28.329 +03:00 [INF] RAMJobStore initialized.
2024-02-25 15:42:28.330 +03:00 [INF] Quartz Scheduler 3.8.0.0 - 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED' initialized
2024-02-25 15:42:28.331 +03:00 [INF] Using thread pool 'Quartz.Simpl.DefaultThreadPool', size: 10
2024-02-25 15:42:28.331 +03:00 [INF] Using job store 'Quartz.Simpl.RAMJobStore', supports persistence: False, clustered: False
2024-02-25 15:42:28.333 +03:00 [INF] JobFactory set to: TgCheckerApi.Job.QuartzJobFactory
2024-02-25 15:42:28.374 +03:00 [INF] Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2024-02-25 15:42:28.526 +03:00 [INF] Now listening on: https://localhost:7256
2024-02-25 15:42:28.527 +03:00 [INF] Now listening on: https://localhost:5244
2024-02-25 15:42:28.530 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-02-25 15:42:28.531 +03:00 [INF] Hosting environment: Development
2024-02-25 15:42:28.532 +03:00 [INF] Content root path: C:\Users\timar\Source\Repos\goldman2g5\TgCheckerApi\TgCheckerApi\
2024-02-25 15:42:28.589 +03:00 [INF] RecalculateTopPosJob started at "2024-02-25T15:42:28.5890907+03:00"
2024-02-25 15:42:28.998 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/swagger/index.html - -
2024-02-25 15:42:29.256 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/swagger/index.html - - - 200 - text/html;charset=utf-8 261.1911ms
2024-02-25 15:42:29.263 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/_framework/aspnetcore-browser-refresh.js - -
2024-02-25 15:42:29.267 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/_vs/browserLink - -
2024-02-25 15:42:29.267 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/_framework/aspnetcore-browser-refresh.js - - - 200 12356 application/javascript;+charset=utf-8 4.0588ms
2024-02-25 15:42:29.279 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 12.0586ms
2024-02-25 15:42:29.393 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/swagger/v1/swagger.json - -
2024-02-25 15:42:29.532 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 138.9291ms
2024-02-25 15:42:30.345 +03:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.avatar, c.bumps, c.description, c.flag, c."Hidden", c."IsPartner", c.language, c.last_bump, c.members, c.name, c.notification_sent, c.notifications, c.promo_post, c.promo_post_interval, c.promo_post_last, c.promo_post_sent, c.promo_post_time, c.telegram_id, c."TopPos", c."Url", c."user"
FROM "Channel" AS c
ORDER BY c.bumps DESC
2024-02-25 15:42:30.516 +03:00 [INF] RecalculateTopPosJob completed at "2024-02-25T15:42:30.5164787+03:00"
2024-02-25 15:42:38.576 +03:00 [INF] Start processing HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:42:38.579 +03:00 [INF] Sending HTTP request POST "https://tgsearch.info:8443/api/Bot/getSubscribersByChannels"
2024-02-25 15:42:49.881 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7256/api/User/PaymentHistory - -
2024-02-25 15:42:50.014 +03:00 [INF] Executing endpoint 'TgCheckerApi.MapperProfiles.UserController.GetPaymentHistory (TgCheckerApi)'
2024-02-25 15:42:50.042 +03:00 [INF] Route matched with {action = "GetPaymentHistory", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[TgCheckerApi.Models.GetModels.PaymentHistoryModel]]] GetPaymentHistory() on controller TgCheckerApi.MapperProfiles.UserController (TgCheckerApi).
2024-02-25 15:42:50.759 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2024-02-25 15:42:50.833 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[@__uniqueKeyClaim_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t.avatar, t.chat_id, t.last_update, t.notification_settings, t.telegram_id, t.unique_key, t.username, t1.id, t1.channel_id, t1.user_id, t1.id0, t1.avatar, t1.bumps, t1.description, t1.flag, t1."Hidden", t1."IsPartner", t1.language, t1.last_bump, t1.members, t1.name, t1.notification_sent, t1.notifications, t1.promo_post, t1.promo_post_interval, t1.promo_post_last, t1.promo_post_sent, t1.promo_post_time, t1.telegram_id, t1."TopPos", t1."Url", t1."user", t1.id1, t1.channel, t1.tag, t1.id00, t1.text, t3.id, t3.channel_id, t3.content, t3.created_at, t3.parent_id, t3.rating, t3.user_id, t3.id0, t3.avatar, t3.bumps, t3.description, t3.flag, t3."Hidden", t3."IsPartner", t3.language, t3.last_bump, t3.members, t3.name, t3.notification_sent, t3.notifications, t3.promo_post, t3.promo_post_interval, t3.promo_post_last, t3.promo_post_sent, t3.promo_post_time, t3.telegram_id, t3."TopPos", t3."Url", t3."user"
FROM (
    SELECT u.id, u.avatar, u.chat_id, u.last_update, u.notification_settings, u.telegram_id, u.unique_key, u.username
    FROM "User" AS u
    WHERE u.unique_key = @__uniqueKeyClaim_0
    LIMIT 2
) AS t
LEFT JOIN (
    SELECT c.id, c.channel_id, c.user_id, c0.id AS id0, c0.avatar, c0.bumps, c0.description, c0.flag, c0."Hidden", c0."IsPartner", c0.language, c0.last_bump, c0.members, c0.name, c0.notification_sent, c0.notifications, c0.promo_post, c0.promo_post_interval, c0.promo_post_last, c0.promo_post_sent, c0.promo_post_time, c0.telegram_id, c0."TopPos", c0."Url", c0."user", t0.id AS id1, t0.channel, t0.tag, t0.id0 AS id00, t0.text
    FROM "ChannelAccess" AS c
    LEFT JOIN "Channel" AS c0 ON c.channel_id = c0.id
    LEFT JOIN (
        SELECT c1.id, c1.channel, c1.tag, t2.id AS id0, t2.text
        FROM "ChannelHasTag" AS c1
        LEFT JOIN "Tag" AS t2 ON c1.tag = t2.id
    ) AS t0 ON c0.id = t0.channel
) AS t1 ON t.id = t1.user_id
LEFT JOIN (
    SELECT c2.id, c2.channel_id, c2.content, c2.created_at, c2.parent_id, c2.rating, c2.user_id, c3.id AS id0, c3.avatar, c3.bumps, c3.description, c3.flag, c3."Hidden", c3."IsPartner", c3.language, c3.last_bump, c3.members, c3.name, c3.notification_sent, c3.notifications, c3.promo_post, c3.promo_post_interval, c3.promo_post_last, c3.promo_post_sent, c3.promo_post_time, c3.telegram_id, c3."TopPos", c3."Url", c3."user"
    FROM "Comment" AS c2
    INNER JOIN "Channel" AS c3 ON c2.channel_id = c3.id
) AS t3 ON t.id = t3.user_id
ORDER BY t.id, t1.id, t1.id0, t1.id1, t1.id00, t3.id
2024-02-25 15:42:50.967 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT p.channel_id AS "ChannelId", p.id AS "PaymentId", p.subtype_id AS "ChannelSubscriptionType", p.created_at AS "PurchaseDate", p.duration AS "SubscriptionDuration", p.amount_value AS "AmountValue", p.amount_currency AS "AmountCurrency"
FROM "Payments" AS p
WHERE p.user_id = @__userId_0 AND p.status = 'Succeeded'
2024-02-25 15:42:50.995 +03:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[TgCheckerApi.Models.GetModels.PaymentHistoryModel, TgCheckerApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-02-25 15:42:51.045 +03:00 [INF] Executed action TgCheckerApi.MapperProfiles.UserController.GetPaymentHistory (TgCheckerApi) in 992.6782ms
2024-02-25 15:42:51.049 +03:00 [INF] Executed endpoint 'TgCheckerApi.MapperProfiles.UserController.GetPaymentHistory (TgCheckerApi)'
2024-02-25 15:42:51.067 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7256/api/User/PaymentHistory - - - 200 4781 application/json;+charset=utf-8 1185.9553ms
